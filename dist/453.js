(self.webpackChunkal=self.webpackChunkal||[]).push([[453],{8133:t=>{t.exports=function(t){var s=[];return t.replace(e,function(t,e,r){var i=e.toLowerCase();for(r=function(t){t=t.match(n);return t?t.map(Number):[]}(r),"m"==i&&2<r.length&&(s.push([e].concat(r.splice(0,2))),i="l",e="m"==e?"l":"L");;){if(r.length==a[i])return r.unshift(e),s.push(r);if(r.length<a[i])throw new Error("malformed path data");s.push([e].concat(r.splice(0,a[i])))}}),s};var a={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/gi;var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},4732:(t,e,r)=>{"use strict";var i=r(8507);class s{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),(this._resizeTo=t)&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(this._resizeTo){this._cancelResize();let t,e;var r,i;e=this._resizeTo===globalThis.window?(t=globalThis.innerWidth,globalThis.innerHeight):({clientWidth:r,clientHeight:i}=this._resizeTo,t=r,i),this.renderer.resize(t,e),this.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}s.extension=i.Ag.Application;var a=r(4458),n=r(7309);class o{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,a.d.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?n.R.shared:new n.R,t.autoStart&&this.start()}static destroy(){var t;this._ticker&&(t=this._ticker,this.ticker=null,t.destroy())}}o.extension=i.Ag.Application,i.XO.add(s),i.XO.add(o)},9935:(t,e,r)=>{"use strict";var i=r(8507);class s{constructor(t){this._renderer=t}push(t,e,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:e,filterEffect:t})}pop(t,e,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(t){"pushFilter"===t.action?this._renderer.filter.push(t):"popFilter"===t.action&&this._renderer.filter.pop()}destroy(){this._renderer=null}}s.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"filter"};var a=r(9313),_=r(5101),n=r(3513),o=r(6011),h=r(7222),v=r(7174),m=r(2437),y=r(5099),l=r(9636),u=r(2208);const d=new a.u;function b(t,e){e.clear(),function e(r,t){if(7!==r.localDisplayStatus||!r.measurable)return;const i=!!r.effects.length;let s=t;(r.isRenderGroupRoot||i)&&(s=u.o.get().clear());if(r.boundsArea)t.addRect(r.boundsArea,r.worldTransform);else{if(r.renderPipeId){const n=r.bounds;s.addFrame(n.minX,n.minY,n.maxX,n.maxY,r.groupTransform)}const a=r.children;for(let t=0;t<a.length;t++)e(a[t],s)}if(i){let e=!1;for(let t=0;t<r.effects.length;t++)r.effects[t].addBounds&&(e||(e=!0,s.applyMatrix(r.renderGroup.worldTransform)),r.effects[t].addBounds(s,!0));e&&(s.applyMatrix(r.renderGroup.worldTransform.copyTo(d).invert()),t.addBounds(s,r.relativeGroupTransform)),t.addBounds(s),u.o.return(s)}else r.isRenderGroupRoot&&(t.addBounds(s,r.relativeGroupTransform),u.o.return(s))}(t,e),e.isValid||e.set(0,0,0,0),t.isRenderGroupRoot?e.applyMatrix(t.renderGroup.localTransform):e.applyMatrix(t.renderGroup.worldTransform)}var S=r(268);const w=new o.V({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),location:0,format:"float32x2",stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class c{constructor(t){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new h.k({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new n.T({}),this.renderer=t}get activeBackTexture(){return this._activeFilterData?.backTexture}push(t){var n=this.renderer,o=t.filterEffect.filters,h=(this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData()),this._filterStack[this._filterStackIndex]);if(this._filterStackIndex++,0===o.length)h.skip=!0;else{var l=h.bounds;if(t.renderables){var u=t.renderables,d=l,c=(d.clear(),d.matrix);for(let t=0;t<u.length;t++){var p=u[t];p.globalDisplayStatus<7||(d.matrix=p.worldTransform,p.addBounds(d))}d.matrix=c}else t.filterEffect.filterArea?(l.clear(),l.addRect(t.filterEffect.filterArea),l.applyMatrix(t.container.worldTransform)):b(t.container,l);var f,c=n.renderTarget.rootRenderTarget.colorTexture.source;let e=c._resolution,r=0,i=c.antialias,s=!1,a=!1;for(let t=0;t<o.length;t++){var g=o[t],x=(e=Math.min(e,g.resolution),r+=g.padding,"inherit"!==g.antialias&&(i="on"===g.antialias),!!(g.compatibleRenderers&n.type));if(!x){a=!1;break}if(g.blendRequired&&!(n.backBuffer?.useBackBuffer??!0)){(0,S.R)("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),a=!1;break}a=g.enabled||a,s=s||g.blendRequired}a&&(f=n.renderTarget.rootViewPort,l.scale(e).fitBounds(0,f.width,0,f.height).scale(1/e).pad(r).ceil(),l.isPositive)?(h.skip=!1,h.bounds=l,h.blendRequired=s,h.container=t.container,h.filterEffect=t.filterEffect,h.previousRenderSurface=n.renderTarget.renderSurface,h.inputTexture=m.W.getOptimalTexture(l.width,l.height,e,i),n.renderTarget.bind(h.inputTexture,!0),n.globalUniforms.push({offset:l})):h.skip=!0}}pop(){var e=this.renderer,i=(this._filterStackIndex--,this._filterStack[this._filterStackIndex]);if(!i.skip){var r,s,a=(this._activeFilterData=i).inputTexture,n=i.bounds;let t=v.g.EMPTY;e.renderTarget.finishRenderPass(),i.blendRequired&&(r=0<this._filterStackIndex?this._filterStack[this._filterStackIndex-1].bounds:null,s=e.renderTarget.getRenderTarget(i.previousRenderSurface),t=this.getBackTexture(s,n,r)),i.backTexture=t;var o=i.filterEffect.filters;if(this._globalFilterBindGroup.setResource(a.source.style,2),this._globalFilterBindGroup.setResource(t.source,3),e.globalUniforms.pop(),1===o.length)o[0].apply(this,a,i.previousRenderSurface,!1),m.W.returnTexture(a);else{let t=i.inputTexture,e=m.W.getOptimalTexture(n.width,n.height,t.source._resolution,!1),r=0;for(r=0;r<o.length-1;++r){o[r].apply(this,t,e,!0);var h=t;t=e,e=h}o[r].apply(this,t,i.previousRenderSurface,!1),m.W.returnTexture(t),m.W.returnTexture(e)}i.blendRequired&&m.W.returnTexture(t)}}getBackTexture(t,e,r){var i=t.colorTexture.source._resolution,s=m.W.getOptimalTexture(e.width,e.height,i,!1);let a=e.minX,n=e.minY;r&&(a-=r.minX,n-=r.minY),a=Math.floor(a*i),n=Math.floor(n*i);r=Math.ceil(e.width*i),e=Math.ceil(e.height*i);return this.renderer.renderTarget.copyToTexture(t,s,{x:a,y:n},{width:r,height:e},{x:0,y:0}),s}applyFilter(t,e,r,i){var s=this.renderer,a=this._filterStack[this._filterStackIndex],n=a.bounds,o=_.b.shared,a=a.previousRenderSurface===r;let h=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,l=this._filterStackIndex-1;for(;0<l&&this._filterStack[l].skip;)--l;0<l&&(h=this._filterStack[l].inputTexture.source._resolution);var u=this._filterGlobalUniforms,d=u.uniforms,c=d.uOutputFrame,p=d.uInputSize,f=d.uInputPixel,g=d.uInputClamp,x=d.uGlobalFrame,d=d.uOutputTexture;if(a){let t=this._filterStackIndex;for(;0<t;){t--;var m=this._filterStack[this._filterStackIndex-1];if(!m.skip){o.x=m.bounds.minX,o.y=m.bounds.minY;break}}c[0]=n.minX-o.x,c[1]=n.minY-o.y}else c[0]=0,c[1]=0;c[2]=e.frame.width,c[3]=e.frame.height,p[0]=e.source.width,p[1]=e.source.height,p[2]=1/p[0],p[3]=1/p[1],f[0]=e.source.pixelWidth,f[1]=e.source.pixelHeight,f[2]=1/f[0],f[3]=1/f[1],g[0]=.5*f[2],g[1]=.5*f[3],g[2]=e.frame.width*p[2]-.5*f[2],g[3]=e.frame.height*p[3]-.5*f[3];a=this.renderer.renderTarget.rootRenderTarget.colorTexture,x[0]=o.x*h,x[1]=o.y*h,x[2]=a.source.width*h,x[3]=a.source.height*h,n=this.renderer.renderTarget.getRenderTarget(r);s.renderTarget.bind(r,!!i),r instanceof v.g?(d[0]=r.frame.width,d[1]=r.frame.height):(d[0]=n.width,d[1]=n.height),d[2]=n.isRoot?-1:1,u.update(),s.renderPipes.uniformBatch?(c=s.renderPipes.uniformBatch.getUboResource(u),this._globalFilterBindGroup.setResource(c,0)):this._globalFilterBindGroup.setResource(u,0),this._globalFilterBindGroup.setResource(e.source,1),this._globalFilterBindGroup.setResource(e.source.style,2),t.groups[0]=this._globalFilterBindGroup,s.encoder.draw({geometry:w,shader:t,state:t._state,topology:"triangle-list"}),s.type===y.W.WEBGL&&s.renderTarget.finishRenderPass()}_getFilterData(){return{skip:!1,inputTexture:null,bounds:new l.c,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}calculateSpriteMatrix(t,e){var r=this._activeFilterData,t=t.set(r.inputTexture._source.width,0,0,r.inputTexture._source.height,r.bounds.minX,r.bounds.minY),r=e.worldTransform.copyTo(a.u.shared);return r.invert(),t.prepend(r),t.scale(1/e.texture.frame.width,1/e.texture.frame.height),t.translate(e.anchor.x,e.anchor.y),t}}c.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem],name:"filter"},i.XO.add(c),i.XO.add(s)},9104:(t,e,r)=>{"use strict";r.d(e,{k:()=>i});const i=16},5611:(t,e,r)=>{"use strict";r.d(e,{I:()=>function({bits:t,name:e}){return new i.M({name:e,...function({template:t,bits:e}){var r=x(t,e);return p[r]||(p[r]=m(t.vertex,t.fragment,e)),p[r]}({template:{vertex:y,fragment:b},bits:[w,...t]})})},v:()=>function({bits:t,name:e}){t=function({template:t,bits:e}){var r=x(t,e);var i;return p[r]||({vertex:t,fragment:i}=function(t,e){var r=e.map(t=>t.vertex).filter(t=>!!t),e=e.map(t=>t.fragment).filter(t=>!!t);var i=u(r,t.vertex,!0);i=function(t,e){const r=[];d(e,r),t.forEach(t=>{t.header&&d(t.header,r)});let i=0;var t=r.sort().map(t=>-1<t.indexOf("builtin")?t:`@location(${i++}) `+t).join(",\n"),s=r.sort().map(t=>{return`       var ${t=t,t.replace(/@.*?\s+/g,"")};`}).join("\n"),a=`return VSOutput(
                ${r.sort().map(t=>" "+function(t){t=/\b(\w+)\s*:/g.exec(t);return t?t[1]:""}(t)).join(",\n")});`;let n=e.replace(/@out\s+[^;]+;\s*/g,"");return n=(n=(n=n.replace("{{struct}}",`
${t}
`)).replace("{{start}}",`
${s}
`)).replace("{{return}}",`
${a}
`)}(r,i);r=u(e,t.fragment,!0);return{vertex:i,fragment:r}}(t,e),p[r]=m(t,i,e)),p[r]}({template:{fragment:v,vertex:_},bits:[S,...t]});return s.B.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}});var i=r(9114),s=r(5881),a=r(268);function n(e,t,r){if(e)for(const s in e){var i=t[s.toLocaleLowerCase()];if(i){let t=e[s];"header"===s&&(t=t.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push(`//----${r}----//`),i.push(t)}else(0,a.R)(s+" placement hook does not exist in shader")}}const o=/\{\{(.*?)\}\}/g;function h(t){const e={};return(t.match(o)?.map(t=>t.replace(/[{()}]/g,""))??[]).forEach(t=>{e[t]=[]}),e}function l(t,e){for(var r,i=/@in\s+([^;]+);/g;null!==(r=i.exec(t));)e.push(r[1])}function u(t,e,r=!1){const i=[];l(e,i),t.forEach(t=>{t.header&&l(t.header,i)});t=i,r&&t.sort(),r=t.map((t,e)=>`       @location(${e}) ${t},`).join("\n");let s=e.replace(/@in\s+[^;]+;\s*/g,"");return s=s.replace("{{in}}",`
${r}
`)}function d(t,e){for(var r,i=/@out\s+([^;]+);/g;null!==(r=i.exec(t));)e.push(r[1])}function c(t,e){let r=t;for(const a in e){var i=e[a],s=i.join("\n");r=s.length?r.replace(`{{${a}}}`,`//-----${a} START-----//
${i.join("\n")}
//----${a} FINISH----//`):r.replace(`{{${a}}}`,"")}return r}const p=Object.create(null),f=new Map;let g=0;function x(t,e){return e.map(t=>(f.has(t)||f.set(t,g++),f.get(t))).sort((t,e)=>t-e).join("-")+t.vertex+t.fragment}function m(t,e,r){const i=h(t),s=h(e);return r.forEach(t=>{n(t.vertex,i,t.name),n(t.fragment,s,t.name)}),{vertex:c(t,i),fragment:c(e,s)}}const _=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,v=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        return outColor * vColor;
      };
`,y=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,b=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
    }
`,S={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}};const w={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}}},6665:(t,e,r)=>{"use strict";r.d(e,{b:()=>i,m:()=>s});const i={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},s={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}}},9114:(t,e,r)=>{"use strict";r.d(e,{M:()=>p});var a=r(7952),i=r(1761);let s;let n;function o(){var t,e;return n||(n="mediump",s&&!s?.isContextLost()||(e=i.e.get().createCanvas(),s=e.getContext("webgl",{})),(e=s)&&e.getShaderPrecisionFormat&&(t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT),n=t.precision?"highp":"mediump")),n}const h={},l={};const u={stripVersion:function(t,e){return e?t.replace("#version 300 es",""):t},ensurePrecision:function(e,r,i){var s=i?r.maxSupportedFragmentPrecision:r.maxSupportedVertexPrecision;if("precision"===e.substring(0,9))return"highp"!==s&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e;{let t=i?r.requestedFragmentPrecision:r.requestedVertexPrecision;return`precision ${t="highp"===t&&"highp"!==s?"mediump":t} float;
`+e}},addProgramDefines:function(t,e,r){return e?t:r?`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${t=t.replace("out vec4 finalColor;","")}
        `:`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${t}
        `},setProgramName:function(t,{name:e="pixi-program"},r=!0){return e=e.replace(/\s+/g,"-"),e+=r?"-fragment":"-vertex",(r=r?h:l)[e]?(r[e]++,e+="-"+r[e]):r[e]=1,-1!==t.indexOf("#define SHADER_NAME")?t:"#define SHADER_NAME "+e+`
`+t},insertVersion:function(t,e){return e?`#version 300 es
`+t:t}},d=Object.create(null),c=class c{constructor(t){var e=-1!==(t={...c.defaultOptions,...t}).fragment.indexOf("#version 300 es");const r={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:o()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let i=t.fragment,s=t.vertex;Object.keys(u).forEach(t=>{var e=r[t];i=u[t](i,e,!0),s=u[t](s,e,!1)}),this.fragment=i,this.vertex=s,this._key=(0,a.X)(this.vertex+":"+this.fragment,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){var e=t.vertex+":"+t.fragment;return d[e]||(d[e]=new c(t)),d[e]}};c.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let p=c},3513:(t,e,r)=>{"use strict";r.d(e,{T:()=>i});class i{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){var r=t[i];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(this._dirty){this._dirty=!1;var e=[];let t=0;for(const r in this.resources)e[t++]=this.resources[r]._resourceId;this._key=e.join("|")}}setResource(t,e){var r=this.resources[e];t!==r&&(r&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){var e=this.resources;for(const r in e)e[r]._touched=t}destroy(){var t=this.resources;for(const e in t)t[e].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){var e=this.resources;for(const r in e)e[r]===t&&(e[r]=null)}else this._updateKey()}}},5881:(t,e,r)=>{"use strict";r.d(e,{B:()=>u});var i=r(7952);const h={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};const l={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function s({source:t,entryPoint:e}){var r={},e=t.indexOf("fn "+e);if(-1!==e){var i=t.indexOf("->",e);if(-1!==i)for(var s,a=t.substring(e,i),n=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;null!==(s=n.exec(a));){var o=l[s[3]]??"float32";r[s[2]]={location:parseInt(s[1],10),format:o,stride:(s=o,(h[s]??h.float32).stride),offset:0,instance:!1,start:0}}}return r}function a(t){const e=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/;const a=/(\w+)\s*:\s*([\w\<\>]+)/g,n=/struct\s+(\w+)/,o=t.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g)?.map(t=>({group:parseInt(t.match(e)[1],10),binding:parseInt(t.match(r)[1],10),name:t.match(i)[2],isUniform:"<uniform>"===t.match(i)[1],type:t.match(s)[1]}));return o?(t=t.match(/struct\s+(\w+)\s*{([^}]+)}/g)?.map(t=>{var e=t.match(n)[1],t=t.match(a).reduce((t,e)=>{var[e,r]=e.split(":");return t[e.trim()]=r.trim(),t},{});return t?{name:e,members:t}:null}).filter(({name:e})=>o.some(t=>t.type===e))??[],{groups:o,structs:t}):{groups:[],structs:[]}}var n=(t=>(t[t.VERTEX=1]="VERTEX",t[t.FRAGMENT=2]="FRAGMENT",t[t.COMPUTE=4]="COMPUTE",t))({});const o=Object.create(null);class u{constructor(t){this._layoutKey=0;var{fragment:t,vertex:e,layout:r,gpuLayout:i,name:s}=t;this.name=s,this.fragment=t,this.vertex=e,t.source===e.source?(s=a(t.source),this.structsAndGroups=s):(s=a(e.source),e=a(t.source),this.structsAndGroups=function(t,e){const r=new Set,i=new Set;return{structs:[...t.structs,...e.structs].filter(t=>!r.has(t.name)&&(r.add(t.name),!0)),groups:[...t.groups,...e.groups].filter(t=>{t=t.name+"-"+t.binding;return!i.has(t)&&(i.add(t),!0)})}}(s,e)),this.layout=r??function({groups:e}){var r=[];for(let t=0;t<e.length;t++){var i=e[t];r[i.group]||(r[i.group]={}),r[i.group][i.name]=i.binding}return r}(this.structsAndGroups),this.gpuLayout=i??function({groups:e}){var r=[];for(let t=0;t<e.length;t++){var i=e[t];r[i.group]||(r[i.group]=[]),i.isUniform?r[i.group].push({binding:i.binding,visibility:n.VERTEX|n.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===i.type?r[i.group].push({binding:i.binding,visibility:n.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===i.type&&r[i.group].push({binding:i.binding,visibility:n.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return r}(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===this.layout[0]?.globalUniforms),this.autoAssignLocalUniforms=!(void 0===this.layout[1]?.localUniforms),this._generateProgramKey()}_generateProgramKey(){var{vertex:t,fragment:e}=this,t=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=(0,i.X)(t,"program")}get attributeData(){return this._attributeData??(this._attributeData=s(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){var e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:`+t.vertex.entryPoint;return o[e]||(o[e]=new u(t)),o[e]}}},949:(t,e,r)=>{"use strict";r.d(e,{h:()=>s});var e=r(4486),n=r(133),i=r(1132);class s extends e.A{constructor(t){let{data:e,size:r}=t;var{usage:t,label:i,shrinkToFit:s}=t,a=(super(),this.uid=(0,n.L)("buffer"),this._resourceType="buffer",this._resourceId=(0,n.L)("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,r=r??e?.byteLength,!!e);this.descriptor={size:r,usage:t,mappedAtCreation:a,label:i},this.shrinkToFit=s??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get static(){return!!(this.descriptor.usage&i.S.STATIC)}set static(t){t?this.descriptor.usage|=i.S.STATIC:this.descriptor.usage&=~i.S.STATIC}setDataWithSize(t,e,r){this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t||(e=this._data,this._data=t,e.length===t.length)||!this.shrinkToFit&&t.byteLength<e.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=(0,n.L)("resource"),this.emit("change",this))}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}},1132:(t,e,r)=>{"use strict";r.d(e,{S:()=>i});var i=(t=>(t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE",t[t.STATIC=1024]="STATIC",t))(i||{})},6011:(t,e,r)=>{"use strict";r.d(e,{V:()=>s});var e=r(4486),n=r(9636),o=r(133),h=r(949),i=r(1132);function l(e,r){if(!(e instanceof h.h)){let t=r?i.S.INDEX:i.S.VERTEX;e instanceof Array&&(t=r?(e=new Uint32Array(e),i.S.INDEX|i.S.COPY_DST):(e=new Float32Array(e),i.S.VERTEX|i.S.COPY_DST)),e=new h.h({data:e,label:r?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return e}class s extends e.A{constructor(t){var{attributes:e,indexBuffer:r,topology:i}=t;super(),this.uid=(0,o.L)("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new n.c,this._boundsDirty=!0,this.attributes=e,this.buffers=[],this.instanceCount=t.instanceCount||1;for(const a in e){var s=e[a]=((s=(s=e[a])instanceof h.h||Array.isArray(s)||s.BYTES_PER_ELEMENT?{buffer:s}:s).buffer=l(s.buffer,!1),s);-1===this.buffers.indexOf(s.buffer)&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this))}r&&(this.indexBuffer=l(r,!0),this.buffers.push(this.indexBuffer)),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const e in this.attributes){var t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;var t=this,a="aPosition",n=this._bounds;if(t=t.getAttribute(a)){var o=t.buffer.data;let e=1/0,r=1/0,i=-1/0,s=-1/0;var a=o.BYTES_PER_ELEMENT,h=(t.offset||0)/a,l=(t.stride||8)/a;for(let t=h;t<o.length;t+=l){var u=o[t],d=o[t+1];u>i&&(i=u),d>s&&(s=d),u<e&&(e=u),d<r&&(r=d)}n.minX=e,n.minY=r,n.maxX=i,n.maxY=s}else n.minX=0,n.minY=0,n.maxX=0,n.maxY=0;return n}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(t=>t.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}},8475:(t,e,r)=>{"use strict";r.d(e,{M:()=>h});var e=r(4486),n=r(9114),f=r(3513),o=r(5881),g=r(5099),x=r(7222);class h extends e.A{constructor(t){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:r,groups:i,resources:s,compatibleRenderers:a,groupMap:n}=t;this.gpuProgram=e,this.glProgram=r,void 0===a&&(a=0,e&&(a|=g.W.WEBGPU),r)&&(a|=g.W.WEBGL),this.compatibleRenderers=a;const o={};if((s=s||i?s:{})&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&i&&!n)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&i&&n)for(const u in n)for(const d in n[u]){var h=n[u][d];o[h]={group:u,binding:d,name:h}}else if(e&&i&&!n){t=e.structsAndGroups.groups;n={},t.forEach(t=>{n[t.group]=n[t.group]||{},n[t.group][t.binding]=t.name,o[t.name]=t})}else if(s){if(e){t=e.structsAndGroups.groups;n={},t.forEach(t=>{n[t.group]=n[t.group]||{},n[t.group][t.binding]=t.name,o[t.name]=t})}else{n={},i={99:new f.T},this._ownedBindGroups.push(i[99]);let t=0;for(const c in s)o[c]={group:99,binding:t,name:c},n[99]=n[99]||{},n[99][t]=c,t++}i={};for(const p in s){var l=p;let t=s[p];t.source||t._resourceType||(t=new x.k(t));l=o[l];l&&(i[l.group]||(i[l.group]=new f.T,this._ownedBindGroups.push(i[l.group])),i[l.group].setResource(t,l.binding))}}this.groups=i,this._uniformBindMap=n,this.resources=this._buildResourceAccessor(i,o)}addResource(t,e,r){var i;(i=this._uniformBindMap)[e]||(i[e]={}),(i=this._uniformBindMap[e])[r]||(i[r]=t),this.groups[e]||(this.groups[e]=new f.T,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(e,t){var r={};for(const i in t){const s=t[i];Object.defineProperty(r,s.name,{get(){return e[s.group].getResource(s.binding)},set(t){e[s.group].setResource(t,s.binding)}})}return r}destroy(t=!1){this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(t=>{t.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:r,...i}=t;let s,a;return e&&(s=o.B.from(e)),r&&(a=n.M.from(r)),new h({gpuProgram:s,glProgram:a,...i})}}},7222:(t,e,r)=>{"use strict";r.d(e,{k:()=>i});var a=r(133),n=r(7952);const o=class o{constructor(e,t){this._touched=0,this.uid=(0,a.L)("uniform"),this._resourceType="uniformGroup",this._resourceId=(0,a.L)("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...o.defaultOptions,...t};var r={};for(const s in this.uniformStructures=e){var i=e[s];i.name=s,i.size=i.size??1,i.value??(i.value=function(t,e){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}(i.type,i.size)),r[s]=i.value}this.uniforms=r,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=(0,n.X)(Object.keys(r).map(t=>t+"-"+e[t].type).join("-"),"uniform-group")}update(){this._dirtyId++}};o.defaultOptions={ubo:!1,isStatic:!1};let i=o},7547:(t,e,r)=>{"use strict";r.d(e,{U:()=>a});const i={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8},s=class s{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}set cullMode(t){"none"===t?this.culling=!1:(this.culling=!0,this.clockwiseFrontFace="front"===t)}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend="none"!==t,this._blendMode=t,this._blendModeId=i[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){var t=new s;return t.depthTest=!1,t.blend=!0,t}};s.default2d=s.for2d();let a=s},7608:(t,e,r)=>{"use strict";r.d(e,{N:()=>a});var i=r(1761),s=r(9939);const a=new class{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){var r=i.e.get().createCanvas(),t=(r.width=t,r.height=e,r.getContext("2d"));return{canvas:r,context:t}}getOptimalCanvasAndContext(t,e,r=1){t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6);r=((t=(0,s.U5)(t))<<17)+((e=(0,s.U5)(e))<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let i=this._canvasPool[r].pop();return i=i||this._createCanvasAndContext(t,e)}returnCanvasAndContext(t){var{width:e,height:r}=t.canvas;this._canvasPool[(e<<17)+(r<<1)].push(t)}clear(){this._canvasPool={}}}},2437:(t,e,r)=>{"use strict";r.d(e,{W:()=>n});var h=r(9939),i=r(6932),s=r(7174);let a=0;const n=new class{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,r){t=new i.v({...this.textureOptions,width:t,height:e,resolution:1,antialias:r,autoGarbageCollect:!0});return new s.g({source:t,label:"texturePool_"+a++})}getOptimalTexture(t,e,r=1,i){var s=Math.ceil(t*r-1e-6),a=Math.ceil(e*r-1e-6),n=((s=(0,h.U5)(s))<<17)+((a=(0,h.U5)(a))<<1)+(i?1:0);this._texturePool[n]||(this._texturePool[n]=[]);let o=this._texturePool[n].pop();return(o=o||this.createTexture(s,a,i)).source._resolution=r,o.source.width=s/r,o.source.height=a/r,o.source.pixelWidth=s,o.source.pixelHeight=a,o.frame.x=0,o.frame.y=0,o.frame.width=t,o.frame.height=e,o.updateUvs(),this._poolKeyHash[o.uid]=n,o}getSameSizeTexture(t,e=!1){var r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,e)}returnTexture(t){var e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=!1!==t)for(const r in this._texturePool){var e=this._texturePool[r];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this._texturePool={}}}},7952:(t,e,r)=>{"use strict";r.d(e,{X:()=>function(t,e){let r=s[t];void 0===r&&(void 0===i[e]&&(i[e]=1),s[t]=r=i[e]++);return r}});const i=Object.create(null),s=Object.create(null)},5099:(t,e,r)=>{"use strict";r.d(e,{W:()=>i});var i=(t=>(t[t.WEBGL=1]="WEBGL",t[t.WEBGPU=2]="WEBGPU",t[t.BOTH=3]="BOTH",t))(i||{})},2760:(t,e,r)=>{"use strict";r.d(e,{V:()=>function(t,e,r){var i=(t>>24&255)/255;e[r++]=(255&t)/255*i,e[r++]=(t>>8&255)/255*i,e[r++]=(t>>16&255)/255*i,e[r++]=i}})},8928:(t,e,r)=>{"use strict";var i=r(8507),s=r(4440),a=r(7547),n=r(8218),o=r(2760),h=r(4389);class l{constructor(t,e){this.state=a.U.for2d(),this._graphicsBatchesHash=Object.create(null),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){var e=t.context,t=!!this._graphicsBatchesHash[t.uid],e=this.renderer.graphicsContext.updateGpuContext(e);return!(!e.isBatchable&&t===e.isBatchable)}addRenderable(t,e){var r=this.renderer.graphicsContext.updateGpuContext(t.context);t._didGraphicsUpdate&&(t._didGraphicsUpdate=!1,this._rebuild(t)),r.isBatchable?this._addToBatcher(t,e):(this.renderer.renderPipes.batch.break(e),e.add(t))}updateRenderable(t){var e=this._graphicsBatchesHash[t.uid];if(e)for(let t=0;t<e.length;t++){var r=e[t];r.batcher.updateElement(r)}}destroyRenderable(t){this._graphicsBatchesHash[t.uid]&&this._removeBatchForRenderable(t.uid)}execute(t){var e,r;t.isRenderable&&(e=this.renderer,r=t.context,e.graphicsContext.getGpuContext(r).batches.length)&&(r=r.customShader||this._adaptor.shader,this.state.blendMode=t.groupBlendMode,(r=r.resources.localUniforms.uniforms).uTransformMatrix=t.groupTransform,r.uRound=e._roundPixels|t._roundPixels,(0,o.V)(t.groupColorAlpha,r.uColor,0),this._adaptor.execute(this,t))}_rebuild(t){var e=!!this._graphicsBatchesHash[t.uid],r=this.renderer.graphicsContext.updateGpuContext(t.context);e&&this._removeBatchForRenderable(t.uid),r.isBatchable&&this._initBatchesForRenderable(t),t.batched=r.isBatchable}_addToBatcher(t,e){var r=this.renderer.renderPipes.batch,i=this._getBatchesForRenderable(t);for(let t=0;t<i.length;t++){var s=i[t];r.addToBatch(s,e)}}_getBatchesForRenderable(t){return this._graphicsBatchesHash[t.uid]||this._initBatchesForRenderable(t)}_initBatchesForRenderable(r){var t=r.context,t=this.renderer.graphicsContext.getGpuContext(t);const i=this.renderer._roundPixels|r._roundPixels;t=t.batches.map(t=>{var e=n.Z.get(h.G);return t.copyTo(e),e.renderable=r,e.roundPixels=i,e});return this._graphicsBatchesHash[r.uid]=t,r.on("destroyed",()=>{this.destroyRenderable(r)}),t}_removeBatchForRenderable(t){this._graphicsBatchesHash[t].forEach(t=>{n.Z.return(t)}),this._graphicsBatchesHash[t]=null}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null;for(const t in this._graphicsBatchesHash)this._removeBatchForRenderable(t);this._graphicsBatchesHash=null}}l.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"graphics"},i.XO.add(l),i.XO.add(s.GH)},4389:(t,e,r)=>{"use strict";r.d(e,{G:()=>i});class i{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(e,r,i){var s=this.geometryData.indices;for(let t=0;t<this.indexSize;t++)e[r++]=s[t+this.indexOffset]+i-this.vertexOffset}packAttributes(e,r,i,s){var t,a=this.geometryData,n=this.renderable,o=a.vertices,h=a.uvs,a=2*this.vertexOffset,l=2*(this.vertexOffset+this.vertexSize),u=this.color,u=u>>16|65280&u|(255&u)<<16;if(this.applyTransform){c=u,t=n.groupColor;var d=(16777215!==c&&t?16777215!==t&&c?((c>>16&255)*(t>>16&255)/255<<16)+((c>>8&255)*(t>>8&255)/255<<8)+(255&c)*(255&t)/255:c:t)+(this.alpha*n.groupAlpha*255<<24),c=n.groupTransform,p=s<<16|65535&this.roundPixels,f=c.a,g=c.b,x=c.c,m=c.d,_=c.tx,v=c.ty;for(let t=a;t<l;t+=2){var y=o[t],b=o[t+1];e[i]=f*y+x*b+_,e[i+1]=g*y+m*b+v,e[i+2]=h[t],e[i+3]=h[t+1],r[i+4]=d,r[i+5]=p,i+=6}}else{var S=u+(255*this.alpha<<24);for(let t=a;t<l;t+=2)e[i]=o[t],e[i+1]=o[t+1],e[i+2]=h[t],e[i+3]=h[t+1],r[i+4]=S,r[i+5]=s<<16,i+=6}}get vertSize(){return this.vertexSize}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.vertexOffset=this.vertexOffset,t.vertexSize=this.vertexSize,t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData}reset(){this.applyTransform=!0}}},4835:(T,t,e)=>{"use strict";e.d(t,{T:()=>Y});var t=e(4486),l=e(2577),n=e(9313),u=e(5101),r=e(7174),i=e(133),s=e(4670),a=e(9636),x=e(268),d=e(8133);var c=e(9252);class o{constructor(t=0,e=0,r=0){this.type="circle",this.x=t,this.y=e,this.radius=r}clone(){return new o(this.x,this.y,this.radius)}contains(t,e){var r;return!(this.radius<=0)&&(r=this.radius*this.radius,t=this.x-t,e=this.y-e,(t*=t)+(e*=e)<=r)}strokeContains(t,e,r){var i;return 0!==this.radius&&(t=this.x-t,e=this.y-e,i=this.radius,r=r/2,(t=Math.sqrt(t*t+e*e))<i+r)&&i-r<t}getBounds(t){return(t=t||new c.M).x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class h{constructor(t=0,e=0,r=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=r,this.halfHeight=i}clone(){return new h(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){return!(this.halfWidth<=0||this.halfHeight<=0)&&(t=(t-this.x)/this.halfWidth,e=(e-this.y)/this.halfHeight,(t*=t)+(e*=e)<=1)}strokeContains(t,e,r){var i,s,{halfWidth:a,halfHeight:n}=this;return!(a<=0||n<=0)&&(i=a+(r=r/2),s=n+r,1<(t=t-this.x)*t/((a=a-r)*a)+(a=e-this.y)*a/((e=n-r)*e))&&t*t/(i*i)+a*a/(s*s)<=1}getBounds(){return new c.M(this.x-this.halfWidth,this.y-this.halfHeight,2*this.halfWidth,2*this.halfHeight)}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}class p{constructor(...t){this.type="polygon";let r=Array.isArray(t[0])?t[0]:t;if("number"!=typeof r[0]){var i=[];for(let t=0,e=r.length;t<e;t++)i.push(r[t].x,r[t].y);r=i}this.points=r,this.closePath=!0}clone(){var t=this.points.slice(),t=new p(t);return t.closePath=this.closePath,t}contains(r,i){let s=!1;var a=this.points.length/2;for(let t=0,e=a-1;t<a;e=t++){var n=this.points[2*t],o=this.points[2*t+1],h=this.points[2*e],l=this.points[2*e+1];i<o!=i<l&&r<(i-o)/(l-o)*(h-n)+n&&(s=!s)}return s}strokeContains(e,r,t){var t=t/2,i=t*t,s=this["points"],a=s.length-(this.closePath?0:2);for(let t=0;t<a;t+=2)if(function(t,e,r,i,s,a){var n=s-r,o=a-i,h=n*n+o*o;let l=-1;0!=h&&(l=((t-r)*n+(e-i)*o)/h);let u,d;return d=l<0?(u=r,i):1<l?(u=s,a):(u=r+l*n,i+l*o),h=t-u,s=e-d,h*h+s*s}(e,r,s[t],s[t+1],s[(t+2)%s.length],s[(t+3)%s.length])<=i)return!0;return!1}getBounds(t){t=t||new c.M;var r=this.points;let i=1/0,s=-1/0,a=1/0,n=-1/0;for(let t=0,e=r.length;t<e;t+=2){var o=r[t],h=r[t+1];i=o<i?o:i,s=o>s?o:s,a=h<a?h:a,n=h>n?h:n}return t.x=i,t.width=s-i,t.y=a,t.height=n-a,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>t+", "+e,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const f=(t,e,r,i,s,a)=>{t-=r,r=e-i,e=Math.sqrt(t*t+r*r);return s-a<=e&&e<=s+a};class g{constructor(t=0,e=0,r=0,i=0,s=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=r,this.height=i,this.radius=s}getBounds(t){return(t=t||new c.M).x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new g(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(!(this.width<=0||this.height<=0)&&t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;var i=t-(this.x+r),s=e-(this.y+r),a=r*r;if(i*i+s*s<=a)return!0;if((i=t-(this.x+this.width-r))*i+s*s<=a)return!0;if(i*i+(s=e-(this.y+this.height-r))*s<=a)return!0;if((i=t-(this.x+r))*i+s*s<=a)return!0}return!1}strokeContains(t,e,r){var{x:i,y:s,width:a,height:n,radius:o}=this,r=r/2,h=i+o,l=s+o,u=i+a,d=s+n;return(i-r<=t&&t<=i+r||u-r<=t&&t<=u+r)&&l<=e&&e<=l+(n-2*o)||(s-r<=e&&e<=s+r||d-r<=e&&e<=d+r)&&h<=t&&t<=h+(a-2*o)||t<h&&e<l&&f(t,e,h,l,o,r)||u-o<t&&e<l&&f(t,e,u-o,l,o,r)||u-o<t&&d-o<e&&f(t,e,u-o,d-o,o,r)||t<h&&d-o<e&&f(t,e,h,d-o,o,r)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var m=e(4440);const k=8,A=1.1920929e-7,C=1,B=.01,R=0,z=0;function W(t,e,r,i,s,a,n,o,h,l){l=Math.min(.99,Math.max(0,l??m.GH.defaultOptions.bezierSmoothness)),l=C-l;(function t(s,a,n,o,h,l,u,d,c,p,e){if(e>k)return;const f=Math.PI;const r=(s+n)/2;const i=(a+o)/2;const g=(n+h)/2;const x=(o+l)/2;const m=(h+u)/2;const _=(l+d)/2;const v=(r+g)/2;const y=(i+x)/2;const b=(g+m)/2;const S=(x+_)/2;const w=(v+b)/2;const T=(y+S)/2;if(0<e){let t=u-s,e=d-a;const M=Math.abs((n-u)*e-(o-d)*t),P=Math.abs((h-u)*e-(l-d)*t);let r,i;if(M>A&&P>A){if((M+P)*(M+P)<=p*(t*t+e*e)){if(R<B)return void c.push(w,T);const C=Math.atan2(l-o,h-n);if(r=Math.abs(C-Math.atan2(o-a,n-s)),i=Math.abs(Math.atan2(d-l,u-h)-C),r>=f&&(r=2*f-r),i>=f&&(i=2*f-i),r+i<R)return void c.push(w,T);if(0!==z){if(r>z)return void c.push(n,o);if(i>z)return void c.push(h,l)}}}else if(M>A){if(M*M<=p*(t*t+e*e)){if(R<B)return void c.push(w,T);if((r=(r=Math.abs(Math.atan2(l-o,h-n)-Math.atan2(o-a,n-s)))>=f?2*f-r:r)<R)return c.push(n,o),void c.push(h,l);if(0!==z&&r>z)return void c.push(n,o)}}else if(P>A){if(P*P<=p*(t*t+e*e)){if(R<B)return void c.push(w,T);if((r=(r=Math.abs(Math.atan2(d-l,u-h)-Math.atan2(l-o,h-n)))>=f?2*f-r:r)<R)return c.push(n,o),void c.push(h,l);if(0!==z&&r>z)return void c.push(h,l)}}else if(t=w-(s+u)/2,e=T-(a+d)/2,t*t+e*e<=p)return void c.push(w,T)}t(s,a,r,i,v,y,w,T,c,p,e+1);t(w,T,b,S,m,_,u,d,c,p,e+1)})(e,r,i,s,a,n,e=o,r=h,i=t,l*=l,0),i.push(e,r)}const F=8,I=1.1920929e-7,U=.01,y=0;function E(t,e,r,i,s,a,n,o){o=1-Math.min(.99,Math.max(0,o??m.GH.defaultOptions.bezierSmoothness));(function t(e,r,i,s,a,n,o,h,l){if(l>F)return;const u=Math.PI;const d=(r+s)/2;const c=(i+a)/2;const p=(s+n)/2;const f=(a+o)/2;const g=(d+p)/2;const x=(c+f)/2;let m=n-r;let _=o-i;const v=Math.abs((s-n)*_-(a-o)*m);if(v>I){if(v*v<=h*(m*m+_*_)){if(y<U)return void e.push(g,x);let t=Math.abs(Math.atan2(o-a,n-s)-Math.atan2(a-i,s-r));if((t=t>=u?2*u-t:t)<y)return void e.push(g,x)}}else if(m=g-(r+n)/2,_=x-(i+o)/2,m*m+_*_<=h)return void e.push(g,x);t(e,r,i,d,c,g,x,h,l+1);t(e,g,x,p,f,n,o,h,l+1)})(t=t,e,r,i,s,e=a,r=n,o*=o,0),t.push(e,r)}function _(e,r,i,s,t,a,n,o){let h=Math.abs(t-a);(!n&&a<t||n&&t<a)&&(h=2*Math.PI-h),o=o||Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI))),o=Math.max(o,3);var l=h/o;let u=t;l*=n?-1:1;for(let t=0;t<o+1;t++){var d=Math.cos(u),c=Math.sin(u);e.push(r+d*s,i+c*s),u+=l}}const O=2*Math.PI,G={centerX:0,centerY:0,ang1:0,ang2:0},D=({x:t,y:e},r,i,s,a,n,o,h)=>{r=a*(t*=r)+s*(e*=i);return h.x=s*t-a*e+n,h.y=r+o,h};const L=(t,e,r,i)=>{let s=t*r+e*i;return(s=1<s?1:s)<-1&&(s=-1),(t*i-e*r<0?-1:1)*Math.acos(s)};function H(a,n,o,h,l,u,d,c=0,p=0,f=0){if(0!==u&&0!==d){var g=Math.sin(c*O/360),x=Math.cos(c*O/360),c=x*(n-h)/2+g*(o-l)/2,m=-g*(n-h)/2+x*(o-l)/2;if(0!=c||0!=m){u=Math.abs(u),d=Math.abs(d);var _=Math.pow(c,2)/Math.pow(u,2)+Math.pow(m,2)/Math.pow(d,2);1<_&&(u*=Math.sqrt(_),d*=Math.sqrt(_));{_=n;n=o;o=h;h=l;l=u;var v=d;var y=g;var b=x;var S=G;var w=Math.pow(l,2),T=Math.pow(v,2),M=Math.pow(c,2),P=Math.pow(m,2);let t=w*T-w*P-T*M;t<0&&(t=0),t/=w*P+T*M;w=(t=Math.sqrt(t)*(p===f?-1:1))*l/v*m,P=t*-v/l*c,T=b*w-y*P+(_+o)/2,M=y*w+b*P+(n+h)/2,p=(c-w)/l,_=(m-P)/v,o=(-c-w)/l,y=(-m-P)/v,b=L(1,0,p,_);let e=L(p,_,o,y);0===f&&0<e&&(e-=O),1===f&&e<0&&(e+=O),S.centerX=T,S.centerY=M,S.ang1=b,S.ang2=e}let{ang1:e,ang2:r}=G;var{centerX:C,centerY:k}=G;let t=Math.abs(r)/(O/4);Math.abs(1-t)<1e-7&&(t=1);var A=Math.max(Math.ceil(t),1);r/=A;let i=a[a.length-2],s=a[a.length-1];var B={x:0,y:0};for(let t=0;t<A;t++){E=e,void 0,U=z=F=I=void 0,I=-1.5707963267948966===(R=r)?-.551915024494:4/3*Math.tan(R/4),I=1.5707963267948966===R?.551915024494:I,F=Math.cos(E),z=Math.sin(E),U=Math.cos(E+R),E=Math.sin(E+R);var R=[{x:F-z*I,y:z+F*I},{x:U+E*I,y:E-U*I},{x:U,y:E}],{x:z,y:F}=D(R[0],u,d,x,g,C,k,B),{x:I,y:U}=D(R[1],u,d,x,g,C,k,B),{x:E,y:R}=D(R[2],u,d,x,g,C,k,B);W(a,i,s,z,F,I,U,E,R),i=E,s=R,e+=r}}}}const V=new c.M;class N{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new a.c,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();var r=this._currentPoly.points,i=r[r.length-2],s=r[r.length-1];return i===t&&s===e||r.push(t,e),this}arc(t,e,r,i,s,a){return this._ensurePoly(!1),_(this._currentPoly.points,t,e,r,i,s,a),this}arcTo(t,e,r,i,s){this._ensurePoly();var a,n,o,h,l,u,d,c=this._currentPoly.points;return t=t,e=e,r=r,i=i,s=s,l=(c=c)[c.length-2],u=c[c.length-1]-e,l-=t,i-=e,r-=t,(d=Math.abs(u*r-l*i))<1e-8||0===s?c[c.length-2]===t&&c[c.length-1]===e||c.push(t,e):(n=u*u+l*l,o=i*i+r*r,h=u*i+l*r,n=(a=s*Math.sqrt(n)/d)*h/n,o=r*(a+(h=(d=s*Math.sqrt(o)/d)*h/o)),h=i*(a+h),_(c,(c=a*r+d*l)+t,(t=a*i+d*u)+e,s,Math.atan2(u*(d+n)-t,l*(d+n)-c),Math.atan2(h-t,o-c),r*u<l*i)),this}arcToSvg(t,e,r,i,s,a,n){return H(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,a,n,t,e,r,i,s),this}bezierCurveTo(t,e,r,i,s,a,n){this._ensurePoly();var o=this._currentPoly;return W(this._currentPoly.points,o.lastX,o.lastY,t,e,r,i,s,a,n),this}quadraticCurveTo(t,e,r,i,s){this._ensurePoly();var a=this._currentPoly;return E(this._currentPoly.points,a.lastX,a.lastY,t,e,r,i,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0)).transform(t);for(let t=0;t<e.instructions.length;t++){var r=e.instructions[t];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,r,i,s){return this.drawShape(new c.M(t,e,r,i),s),this}circle(t,e,r,i){return this.drawShape(new o(t,e,r),i),this}poly(t,e,r){t=new p(t);return t.closePath=e,this.drawShape(t,r),this}regularPoly(e,r,i,s,t=0,a){s=Math.max(0|s,3);var n=-1*Math.PI/2+t,o=2*Math.PI/s,h=[];for(let t=0;t<s;t++){var l=t*o+n;h.push(e+i*Math.cos(l),r+i*Math.sin(l))}return this.poly(h,!0,a),this}roundPoly(e,r,i,s,a,t=0,n){if(s=Math.max(0|s,3),a<=0)return this.regularPoly(e,r,i,s,t);var o=i*Math.sin(Math.PI/s)-.001,h=(a=Math.min(a,o),-1*Math.PI/2+t),l=2*Math.PI/s,u=(s-2)*Math.PI/s/2;for(let t=0;t<s;t++){var d=t*l+h,c=e+i*Math.cos(d),p=r+i*Math.sin(d),f=d+Math.PI+u,d=d-Math.PI-u,g=c+a*Math.cos(f),f=p+a*Math.sin(f),x=c+a*Math.cos(d),d=p+a*Math.sin(d);0===t?this.moveTo(g,f):this.lineTo(g,f),this.quadraticCurveTo(c,p,x,d,n)}return this.closePath()}roundShape(e,r,t=!1,i){if(e.length<3)return this;if(t){var s=this,a=e,n=r,o=i,h=(t,e)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),l=(t,e,r)=>({x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}),u=a.length;for(let r=0;r<u;r++){var d=a[(r+1)%u],c=d.radius??n;if(c<=0)0===r?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y);else{var p=a[r],f=a[(r+2)%u],g=h(p,d);let t;t=g<1e-4?d:l(d,p,Math.min(g/2,c)/g);p=h(f,d);let e;e=p<1e-4?d:l(d,f,Math.min(p/2,c)/p),0===r?s.moveTo(t.x,t.y):s.lineTo(t.x,t.y),s.quadraticCurveTo(d.x,d.y,e.x,e.y,o)}}}else{var x=this;var m=e;var _=r;var v=(t,e)=>{var r=e.x-t.x,e=e.y-t.y,t=Math.sqrt(r*r+e*e);return{len:t,nx:r/t,ny:e/t}},y=(t,e)=>{0===t?x.moveTo(e.x,e.y):x.lineTo(e.x,e.y)};let t=m[m.length-1];for(let a=0;a<m.length;a++){var b=m[a%m.length],S=b.radius??_;if(S<=0)y(a,b);else{var w=m[(a+1)%m.length],T=v(b,t),w=v(b,w);if(T.len<1e-4||w.len<1e-4)y(a,b);else{let t=Math.asin(T.nx*w.ny-T.ny*w.nx),e=1,r=!1;T.nx*w.nx-T.ny*-w.ny<0?t<0?t=Math.PI+t:(t=Math.PI-t,e=-1,r=!0):0<t&&(e=-1,r=!0);var M=t/2;let i,s=Math.abs(Math.cos(M)*S/Math.sin(M));i=s>Math.min(T.len/2,w.len/2)?(s=Math.min(T.len/2,w.len/2),Math.abs(s*Math.sin(M)/Math.cos(M))):S;M=b.x+w.nx*s+-w.ny*i*e,S=b.y+w.ny*s+w.nx*i*e,T=Math.atan2(T.ny,T.nx)+Math.PI/2*e,w=Math.atan2(w.ny,w.nx)-Math.PI/2*e;0===a&&x.moveTo(M+Math.cos(T)*i,S+Math.sin(T)*i),x.arc(M,S,i,T,w,r)}}t=b}}return this.closePath()}filletRect(t,e,r,i,s){var a,n;return 0===s?this.rect(t,e,r,i):(n=Math.min(r,i)/2,a=t+r,i=e+i,s=(n=Math.min(n,Math.max(-n,s)))<0?-n:0,n=Math.abs(n),this.moveTo(t,e+n).arcTo(t+s,e+s,t+n,e,n).lineTo(a-n,e).arcTo(a-s,e+s,a,e+n,n).lineTo(a,i-n).arcTo(a-s,i-s,t+r-n,i,n).lineTo(t+n,i).arcTo(t+s,i-s,t,i-n,n).closePath())}chamferRect(t,e,r,i,s,a){if(s<=0)return this.rect(t,e,r,i);var s=Math.min(s,Math.min(r,i)/2),r=t+r,i=e+i,n=[t+s,e,r-s,e,r,e+s,r,i-s,r-s,i,t+s,i,t,i-s,t,e+s];for(let t=n.length-1;2<=t;t-=2)n[t]===n[t-2]&&n[t-1]===n[t-3]&&n.splice(t-1,2);return this.poly(n,!0,a)}ellipse(t,e,r,i,s){return this.drawShape(new h(t,e,r,i),s),this}roundRect(t,e,r,i,s,a){return this.drawShape(new g(t,e,r,i,s),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){var r=this._currentPoly;return r&&this.endPoly(),(r=new p).points.push(t,e),this._currentPoly=r,this}endPoly(t=!1){var e=this._currentPoly;return e&&2<e.points.length&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(r=!0){if(!this._currentPoly&&(this._currentPoly=new p,r)){var i,r=this.shapePrimitives[this.shapePrimitives.length-1];if(r){let t=r.shape.x,e=r.shape.y;r.transform.isIdentity()||(r=r.transform,i=t,t=r.a*t+r.c*e+r.tx,e=r.b*i+r.d*e+r.ty),this._currentPoly.points.push(t,e)}else this._currentPoly.points.push(0,0)}}buildPath(){var e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){var r=e.instructions[t];this[r.action](...r.data)}this.finish()}get bounds(){var e=this._bounds,r=(e.clear(),this.shapePrimitives);for(let t=0;t<r.length;t++){var i=r[t],s=i.shape.getBounds(V);i.transform?e.addRect(s,i.transform):e.addRect(s)}return e}}class M{constructor(t){if(this.instructions=[],this.uid=(0,i.L)("graphicsPath"),this._dirty=!0,"string"==typeof t){var s=t;var a=this;var n=d(s),o=[];let e=null,r=0,i=0;for(let t=0;t<n.length;t++){var h=n[t],l=h[0],u=h;switch(l){case"M":r=u[1],i=u[2],a.moveTo(r,i);break;case"m":r+=u[1],i+=u[2],a.moveTo(r,i);break;case"H":r=u[1],a.lineTo(r,i);break;case"h":r+=u[1],a.lineTo(r,i);break;case"V":i=u[1],a.lineTo(r,i);break;case"v":i+=u[1],a.lineTo(r,i);break;case"L":r=u[1],i=u[2],a.lineTo(r,i);break;case"l":r+=u[1],i+=u[2],a.lineTo(r,i);break;case"C":r=u[5],i=u[6],a.bezierCurveTo(u[1],u[2],u[3],u[4],r,i);break;case"c":a.bezierCurveTo(r+u[1],i+u[2],r+u[3],i+u[4],r+u[5],i+u[6]),r+=u[5],i+=u[6];break;case"S":r=u[3],i=u[4],a.bezierCurveToShort(u[1],u[2],r,i);break;case"s":a.bezierCurveToShort(r+u[1],i+u[2],r+u[3],i+u[4]),r+=u[3],i+=u[4];break;case"Q":r=u[3],i=u[4],a.quadraticCurveTo(u[1],u[2],r,i);break;case"q":a.quadraticCurveTo(r+u[1],i+u[2],r+u[3],i+u[4]),r+=u[3],i+=u[4];break;case"T":r=u[1],i=u[2],a.quadraticCurveToShort(r,i);break;case"t":r+=u[1],i+=u[2],a.quadraticCurveToShort(r,i);break;case"A":r=u[6],i=u[7],a.arcToSvg(u[1],u[2],u[3],u[4],u[5],r,i);break;case"a":r+=u[6],i+=u[7],a.arcToSvg(u[1],u[2],u[3],u[4],u[5],r,i);break;case"Z":case"z":a.closePath(),0<o.length&&(e=o.pop(),i=e?(r=e.startX,e.startY):r=0),e=null;break;default:(0,x.R)("Unknown SVG path command: "+l)}"Z"!==l&&"z"!==l&&null===e&&(e={startX:r,startY:i},o.push(e))}}else this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new N(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,r,i,s){var a,n=this.instructions[this.instructions.length-1],o=this.getLastPoint(u.b.shared);let h=0,l=0;return l=n&&"bezierCurveTo"===n.action?(h=n.data[2],l=n.data[3],n=o.x,a=o.y,h=n+(n-h),a+(a-l)):(h=o.x,o.y),this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,r,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,r){var i,s=this.instructions[this.instructions.length-1],a=this.getLastPoint(u.b.shared);let n=0,o=0;return o=s&&"quadraticCurveTo"===s.action?(n=s.data[0],o=s.data[1],s=a.x,i=a.y,n=s+(s-n),i+(i-o)):(n=a.x,a.y),this.instructions.push({action:"quadraticCurveTo",data:[n,o,t,e,r]}),this._dirty=!0,this}rect(t,e,r,i,s){return this.instructions.push({action:"rect",data:[t,e,r,i,s]}),this._dirty=!0,this}circle(t,e,r,i){return this.instructions.push({action:"circle",data:[t,e,r,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(e,r,t,i,s,a,n){s=s||i/2;var o=-1*Math.PI/2+a,h=2*t,l=2*Math.PI/h,u=[];for(let t=0;t<h;t++){var d=t%2?s:i,c=t*l+o;u.push(e+d*Math.cos(c),r+d*Math.sin(c))}return this.poly(u,!0,n),this}clone(t=!1){var e=new M;if(t)for(let t=0;t<this.instructions.length;t++){var r=this.instructions[t];e.instructions.push({action:r.action,data:r.data.slice()})}else e.instructions=this.instructions.slice();return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(a){if(!a.isIdentity()){var n=a.a,o=a.b,h=a.c,l=a.d,u=a.tx,d=a.ty;let e=0,r=0,i=0,s=0;var c,p;for(let t=0;t<this.instructions.length;t++){var f=this.instructions[t],g=f.data;switch(f.action){case"moveTo":case"lineTo":e=g[0],r=g[1],g[0]=n*e+h*r+u,g[1]=o*e+l*r+d;break;case"bezierCurveTo":i=g[0],s=g[1],c=g[2],p=g[3],e=g[4],r=g[5],g[0]=n*i+h*s+u,g[1]=o*i+l*s+d,g[2]=n*c+h*p+u,g[3]=o*c+l*p+d,g[4]=n*e+h*r+u,g[5]=o*e+l*r+d;break;case"quadraticCurveTo":i=g[0],s=g[1],e=g[2],r=g[3],g[0]=n*i+h*s+u,g[1]=o*i+l*s+d,g[2]=n*e+h*r+u,g[3]=o*e+l*r+d;break;case"arcToSvg":e=g[5],r=g[6],c=g[0],p=g[1],g[0]=n*c+h*p,g[1]=o*c+l*p,g[5]=n*e+h*r+u,g[6]=o*e+l*r+d;break;case"circle":g[4]=v(g[3],a);break;case"rect":g[4]=v(g[4],a);break;case"ellipse":g[8]=v(g[8],a);break;case"roundRect":g[5]=v(g[5],a);break;case"addPath":g[0].transform(a);break;case"poly":g[2]=v(g[2],a);break;default:(0,x.R)("unknown transform action",f.action)}}this._dirty=!0}return this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,r=this.instructions[e];if(r){for(;"closePath"===r.action;){if(--e<0)return t.x=0,t.y=0,t;r=this.instructions[e]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t)}}else t.x=0,t.y=0;return t}}function v(t,e){return t?t.prepend(e):e.clone()}function $(t,e){"string"==typeof t&&((r=document.createElement("div")).innerHTML=t.trim(),t=r.querySelector("svg"));var r={context:e,path:new M};!function e(t,r,i,s){const a=t.children;const{fillStyle:n,strokeStyle:o}=X(t);n&&i?i={...i,...n}:n&&(i=n);o&&s?s={...s,...o}:o&&(s=o);r.context.fillStyle=i;r.context.strokeStyle=s;let h;let l;let u;let d;let c;let p;let f;let g;let x;let m;let _;let v;let y;let b;let S;let w;let T;switch(t.nodeName.toLowerCase()){case"path":b=t.getAttribute("d"),S=new M(b),r.context.path(S),i&&r.context.fill(),s&&r.context.stroke();break;case"circle":f=P(t,"cx",0),g=P(t,"cy",0),x=P(t,"r",0),r.context.ellipse(f,g,x,x),i&&r.context.fill(),s&&r.context.stroke();break;case"rect":h=P(t,"x",0),l=P(t,"y",0),w=P(t,"width",0),T=P(t,"height",0),m=P(t,"rx",0),_=P(t,"ry",0),m||_?r.context.roundRect(h,l,w,T,m||_):r.context.rect(h,l,w,T),i&&r.context.fill(),s&&r.context.stroke();break;case"ellipse":f=P(t,"cx",0),g=P(t,"cy",0),m=P(t,"rx",0),_=P(t,"ry",0),r.context.beginPath(),r.context.ellipse(f,g,m,_),i&&r.context.fill(),s&&r.context.stroke();break;case"line":u=P(t,"x1",0),d=P(t,"y1",0),c=P(t,"x2",0),p=P(t,"y2",0),r.context.beginPath(),r.context.moveTo(u,d),r.context.lineTo(c,p),s&&r.context.stroke();break;case"polygon":y=t.getAttribute("points"),v=y.match(/\d+/g).map(t=>parseInt(t,10)),r.context.poly(v,!0),i&&r.context.fill(),s&&r.context.stroke();break;case"polyline":y=t.getAttribute("points"),v=y.match(/\d+/g).map(t=>parseInt(t,10)),r.context.poly(v,!1),s&&r.context.stroke();break;case"g":case"svg":break;default:console.info(`[SVG parser] <${t.nodeName}> elements unsupported`)}for(let t=0;t<a.length;t++)e(a[t],r,i,s)}(t,r,null,null)}function P(t,e,r){t=t.getAttribute(e);return t?Number(t):r}function X(t){var e=t.getAttribute("style"),r={},i={};let s=!1,a=!1;if(e){var n=e.split(";");for(let t=0;t<n.length;t++){var[o,h]=n[t].split(":");switch(o){case"stroke":"none"!==h&&(r.color=l.Q.shared.setValue(h).toNumber(),a=!0);break;case"stroke-width":r.width=Number(h);break;case"fill":"none"!==h&&(s=!0,i.color=l.Q.shared.setValue(h).toNumber());break;case"fill-opacity":i.alpha=Number(h);break;case"stroke-opacity":r.alpha=Number(h);break;case"opacity":i.alpha=Number(h),r.alpha=Number(h)}}}else{e=t.getAttribute("stroke"),e=(e&&"none"!==e&&(a=!0,r.color=l.Q.shared.setValue(e).toNumber(),r.width=P(t,"stroke-width",1)),t.getAttribute("fill"));e&&"none"!==e&&(s=!0,i.color=l.Q.shared.setValue(e).toNumber())}return{strokeStyle:a?r:null,fillStyle:s?i:null}}var b=e(990);const j=new u.b,S=new n.u,w=class w extends t.A{constructor(){super(...arguments),this.uid=(0,i.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new M,this._transform=new n.u,this._fillStyle={...w.defaultFillStyle},this._strokeStyle={...w.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new a.c,this._boundsDirty=!0}clone(){var t=new w;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=(0,b.M)(t,w.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=(0,b.M)(t,w.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=(0,b.M)(t,w.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=(0,b.M)(t,w.defaultStrokeStyle),this}texture(t,e,r,i,s,a){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:i||0,dw:s||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?l.Q.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new M,this}fill(t,e){let r;var i=this.instructions[this.instructions.length-1];return(r=0===this._tick&&i&&"stroke"===i.action?i.data.path:this._activePath.clone())&&(null!=t&&(void 0!==e&&"number"==typeof t&&((0,s.t)(s.l,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=(0,b.M)(t,w.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}_initNextPathLocation(){var{x:t,y:e}=this._activePath.getLastPoint(u.b.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;var r=this.instructions[this.instructions.length-1];return(e=0===this._tick&&r&&"fill"===r.action?r.data.path:this._activePath.clone())&&(null!=t&&(this._strokeStyle=(0,b.M)(t,w.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}cut(){for(let t=0;t<2;t++){var e=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(e&&("stroke"===e.action||"fill"===e.action)){if(!e.data.hole){e.data.hole=r;break}e.data.hole.addPath(r)}}return this._initNextPathLocation(),this}arc(t,e,r,i,s,a){this._tick++;var n=this._transform;return this._activePath.arc(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty,r,i,s,a),this}arcTo(t,e,r,i,s){this._tick++;var a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*r+a.c*i+a.tx,a.b*r+a.d*i+a.ty,s),this}arcToSvg(t,e,r,i,s,a,n){this._tick++;var o=this._transform;return this._activePath.arcToSvg(t,e,r,i,s,o.a*a+o.c*n+o.tx,o.b*a+o.d*n+o.ty),this}bezierCurveTo(t,e,r,i,s,a,n){this._tick++;var o=this._transform;return this._activePath.bezierCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,o.a*s+o.c*a+o.tx,o.b*s+o.d*a+o.ty,n),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,r,i){return this._tick++,this._activePath.ellipse(t,e,r,i,this._transform.clone()),this}circle(t,e,r){return this._tick++,this._activePath.circle(t,e,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;var r=this._transform;return this._activePath.lineTo(r.a*t+r.c*e+r.tx,r.b*t+r.d*e+r.ty),this}moveTo(t,e){this._tick++;var r=this._transform,i=this._activePath.instructions,s=r.a*t+r.c*e+r.tx,t=r.b*t+r.d*e+r.ty;return 1===i.length&&"moveTo"===i[0].action?(i[0].data[0]=s,i[0].data[1]=t):this._activePath.moveTo(s,t),this}quadraticCurveTo(t,e,r,i,s){this._tick++;var a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*r+a.c*i+a.tx,a.b*r+a.d*i+a.ty,s),this}rect(t,e,r,i){return this._tick++,this._activePath.rect(t,e,r,i,this._transform.clone()),this}roundRect(t,e,r,i,s){return this._tick++,this._activePath.roundRect(t,e,r,i,s,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,r,i,s=0,a){return this._tick++,this._activePath.regularPoly(t,e,r,i,s,a),this}roundPoly(t,e,r,i,s,a){return this._tick++,this._activePath.roundPoly(t,e,r,i,s,a),this}roundShape(t,e,r,i){return this._tick++,this._activePath.roundShape(t,e,r,i),this}filletRect(t,e,r,i,s){return this._tick++,this._activePath.filletRect(t,e,r,i,s),this}chamferRect(t,e,r,i,s,a){return this._tick++,this._activePath.chamferRect(t,e,r,i,s,a),this}star(t,e,r,i,s=0,a=0){return this._tick++,this._activePath.star(t,e,r,i,s,a,this._transform.clone()),this}svg(t){return this._tick++,$(t,this),this}restore(){var t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,r,i,s,a){return t instanceof n.u?this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty):this._transform.set(t,e,r,i,s,a),this}transform(t,e,r,i,s,a){return t instanceof n.u?this._transform.append(t):(S.set(t,e,r,i,s,a),this._transform.append(S)),this}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;var e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){var r,i=this.instructions[t],s=i.action;"fill"===s?(r=i.data,e.addBounds(r.path.bounds)):"texture"===s&&(r=i.data,e.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)),"stroke"===s&&(i=(s=i.data).style.width/2,s=s.path.bounds,e.addFrame(s.minX-i,s.minY-i,s.maxX+i,s.maxY+i))}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;var r=this.instructions;let i=!1;for(let t=0;t<r.length;t++){var s=r[t],a=s.data,n=a.path;if(s.action&&n){var o=a.style,h=n.shapePath.shapePrimitives;for(let t=0;t<h.length;t++){var l=h[t].shape;if(o&&l){var u=h[t].transform,d=u?u.applyInverse(e,j):e,u=(i="fill"===s.action?l.contains(d.x,d.y):l.strokeContains(d.x,d.y,o.width),a.hole);if(u){var c=u.shapePath?.shapePrimitives;if(c)for(let t=0;t<c.length;t++)c[t].shape.contains(d.x,d.y)&&(i=!1)}if(i)return!0}}}}return i}destroy(t=!1){this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),("boolean"==typeof t?t:t?.texture)&&(t="boolean"==typeof t?t:t?.textureSource,this._fillStyle.texture&&this._fillStyle.texture.destroy(t),this._strokeStyle.texture)&&this._strokeStyle.texture.destroy(t),this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};w.defaultFillStyle={color:16777215,alpha:1,texture:r.g.WHITE,matrix:null,fill:null},w.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:r.g.WHITE,matrix:null,fill:null};let Y=w},4440:(P,t,e)=>{"use strict";e.d(t,{GH:()=>F});var t=e(8507),r=e(949),i=e(1132),s=e(6011);const a=new Float32Array(1),n=new Uint32Array(1);class o extends s.V{constructor(){var t=new r.h({data:a,label:"attribute-batch-buffer",usage:i.S.VERTEX|i.S.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:24,offset:0,location:1},aUV:{buffer:t,format:"float32x2",stride:24,offset:8,location:3},aColor:{buffer:t,format:"unorm8x4",stride:24,offset:16,location:0},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:24,offset:20,location:2}},indexBuffer:new r.h({data:n,label:"index-batch-buffer",usage:i.S.INDEX|i.S.COPY_DST,shrinkToFit:!1})})}}var h=e(3513),W=e(7174),x=e(9104);const l={};function u(e,r){let i=0;for(let t=0;t<r;t++)i=31*i+e[t].uid>>>0;return l[i]||function(e,t){var r={};let i=0;for(let t=0;t<x.k;t++){var s=t<e.length?e[t]:W.g.EMPTY.source;r[i++]=s.source,r[i++]=s.style}var a=new h.T(r);return l[t]=a}(e,i)}var d=e(133);class c{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[t+"View"]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}}}function p(t,e){var r=t.byteLength/8|0,i=new Float64Array(t,0,r),i=(new Float64Array(e,0,r).set(i),t.byteLength-8*r);0<i&&(t=new Uint8Array(t,8*r,i),new Uint8Array(e,8*r,i).set(t))}const f={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};function m(t,e){return"no-premultiply-alpha"===e.alphaMode&&f[t]||t}class _{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){var e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class v{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}let y=0;const g=class g{constructor(t={}){this.uid=(0,d.L)("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._vertexSize=6,this._elements=[],this._batchPool=[],this._batchPoolIndex=0,this._textureBatchPool=[],this._textureBatchPoolIndex=0;var{vertexSize:t,indexSize:e}=t={...g.defaultOptions,...t};this.attributeBuffer=new c(t*this._vertexSize*4),this.indexBuffer=new Uint16Array(e)}begin(){this.batchIndex=0,this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0,this._batchPoolIndex=0,this._textureBatchPoolIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){(this._elements[this.elementSize++]=t).indexStart=this.indexSize,t.location=this.attributeSize,(t.batcher=this).indexSize+=t.indexSize,this.attributeSize+=t.vertexSize*this._vertexSize}checkAndUpdateTexture(t,e){var r=t.batch.textures.ids[e._source.uid];return!(!r&&0!==r||(t.textureId=r,t.texture=e,0))}updateElement(t){this.dirty=!0,t.packAttributes(this.attributeBuffer.float32View,this.attributeBuffer.uint32View,t.location,t.textureId)}break(n){var o=this._elements;let h=this._textureBatchPool[this._textureBatchPoolIndex++]||new _;if(h.clear(),o[this.elementStart]){var t=o[this.elementStart];let e=m(t.blendMode,t.texture._source);4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);var l=this.attributeBuffer.float32View,u=this.attributeBuffer.uint32View,d=this.indexBuffer;let r=this._batchIndexSize,i=this._batchIndexStart,s="startBatch",a=this._batchPool[this._batchPoolIndex++]||new v;for(let t=this.elementStart;t<this.elementSize;++t){var c=o[t],p=(o[t]=null,c.texture),p=p._source,f=m(c.blendMode,p),g=e!==f;p._batchTick!==y||g?(p._batchTick=y,(h.count>=x.k||g)&&(this._finishBatch(a,i,r-i,h,e,n,s),s="renderBatch",i=r,e=f,(h=this._textureBatchPool[this._textureBatchPoolIndex++]||new _).clear(),a=this._batchPool[this._batchPoolIndex++]||new v,++y),c.textureId=p._textureBindLocation=h.count,h.ids[p.uid]=h.count,h.textures[h.count++]=p,c.batch=a,r+=c.indexSize,c.packAttributes(l,u,c.location,c.textureId),c.packIndex(d,c.indexStart,c.location/this._vertexSize)):(c.textureId=p._textureBindLocation,r+=c.indexSize,c.packAttributes(l,u,c.location,c.textureId),c.packIndex(d,c.indexStart,c.location/this._vertexSize),c.batch=a)}0<h.count&&(this._finishBatch(a,i,r-i,h,e,n,s),i=r,++y),this.elementStart=this.elementSize,this._batchIndexStart=i,this._batchIndexSize=r}}_finishBatch(t,e,r,i,s,a,n){t.gpuBindGroup=null,t.action=n,t.batcher=this,t.textures=i,t.blendMode=s,t.start=e,t.size=r,++y,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){4*t<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*t)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){t=Math.max(t,2*this.attributeBuffer.size),t=new c(t);p(this.attributeBuffer.rawBinaryData,t.rawBinaryData),this.attributeBuffer=t}_resizeIndexBuffer(t){var e=this.indexBuffer,t=Math.max(t,1.5*e.length),r=new(65535<(t+=t%2)?Uint32Array:Uint16Array)(t);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let t=0;t<e.length;t++)r[t]=e[t];else p(e.buffer,r.buffer);this.indexBuffer=r}destroy(){for(let t=0;t<this.batches.length;t++)this.batches[t].destroy();this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t].batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};g.defaultOptions={vertexSize:4,indexSize:6};let b=g;var S=e(848),O=e(8218),s=e(9252);function G(e,t,r,i,s){var a=t.a,n=t.b,o=t.c,h=t.d,l=t.tx,u=t.ty;r=r||0,i=i||2,s=s||e.length/i-r;let d=r*i;for(let t=0;t<s;t++){var c=e[d],p=e[d+1];e[d]=a*c+o*p+l,e[d+1]=n*c+h*p+u,d+=i}}var D=e(4389),w={build(t,a){let n,o,h,l,u,d;if("circle"===t.type?(n=t.x,o=t.y,u=d=t.radius,h=l=0):"ellipse"===t.type?(n=t.x,o=t.y,u=t.halfWidth,d=t.halfHeight,h=l=0):(p=t.width/2,f=t.height/2,n=t.x+p,o=t.y+f,u=d=Math.max(0,Math.min(t.radius,Math.min(p,f))),h=p-u,l=f-d),0<=u&&0<=d&&0<=h&&0<=l){var c=Math.ceil(2.3*Math.sqrt(u+d)),t=8*c+(h?4:0)+(l?4:0);if(0!=t)if(0===c)a[0]=a[6]=n+h,a[1]=a[3]=o+l,a[2]=a[4]=n-h,a[5]=a[7]=o-l;else{let e=0,r=4*c+(h?2:0)+2,i=r,s=t;var p=h+u,f=l,t=n+p,g=n-p,x=o+f;a[e++]=t,a[e++]=x,a[--r]=x,a[--r]=g,l&&(b=o-f,a[i++]=g,a[i++]=b,a[--s]=b,a[--s]=t);for(let t=1;t<c;t++){var m=Math.PI/2*(t/c),_=h+Math.cos(m)*u,m=l+Math.sin(m)*d,v=n+_,_=n-_,y=o+m,m=o-m;a[e++]=v,a[e++]=y,a[--r]=y,a[--r]=_,a[i++]=_,a[i++]=m,a[--s]=m,a[--s]=v}var p=h,f=l+d,t=n+p,g=n-p,x=o+f,b=o-f;a[e++]=t,a[e++]=x,a[--s]=b,a[--s]=t,h&&(a[e++]=g,a[e++]=x,a[--s]=b,a[--s]=g)}}return a},triangulate(s,a,n,t,o,h){if(0!==s.length){let e=0,r=0;for(let t=0;t<s.length;t+=2)e+=s[t],r+=s[t+1];e/=s.length/2,r/=s.length/2;let i=t;a[i*n]=e,a[i*n+1]=r;var l=i++;for(let t=0;t<s.length;t+=2)a[i*n]=s[t],a[i*n+1]=s[t+1],0<t&&(o[h++]=i,o[h++]=l,o[h++]=i-1),i++;o[h++]=1+l,o[h++]=l,o[h++]=i-1}}},L=e(5101);const j=1e-4,H=1e-4;function V(t,e,r,i,s,a,n,o){let h,l;l=n?(h=i,-r):(h=-i,r);n=t-r*s+h,s=e-i*s+l,t=t+r*a+h,r=e+i*a+l;return o.push(n,s),o.push(t,r),2}function N(r,i,t,e,s,a,n,o){var h=t-r,l=e-i;let u=Math.atan2(h,l),d=Math.atan2(s-r,a-i);o&&u<d?u+=2*Math.PI:!o&&u>d&&(d+=2*Math.PI);var c=u,p=d-u,f=Math.abs(p),g=Math.sqrt(h*h+l*l),x=1+(15*f*Math.sqrt(g)/Math.PI>>0),m=p/x;if(c+=m,o){n.push(r,i),n.push(t,e);for(let t=1,e=c;t<x;t++,e+=m)n.push(r,i),n.push(r+Math.sin(e)*g,i+Math.cos(e)*g);n.push(r,i),n.push(s,a)}else{n.push(t,e),n.push(r,i);for(let t=1,e=c;t<x;t++,e+=m)n.push(r+Math.sin(e)*g,i+Math.cos(e)*g),n.push(r,i);n.push(s,a),n.push(r,i)}return 2*x}function Y(c,t,p,f,g,e,r,x){var m=j;if(0!==c.length){var _=t;let e=_.alignment;if(.5!==t.alignment){let t=function(i){var s=i.length;if(s<6)return 1;let a=0;for(let t=0,e=i[s-2],r=i[s-1];t<s;t+=2){var n=i[t],o=i[t+1];a+=(n-e)*(o+r),e=n,r=o}return a<0?-1:1}(c);p&&(t*=-1),e=(e-.5)*t+.5}var t=new L.b(c[0],c[1]),p=new L.b(c[c.length-2],c[c.length-1]),m=Math.abs(t.x-p.x)<m&&Math.abs(t.y-p.y)<m,v=(f&&(c=c.slice(),m&&(c.pop(),c.pop(),p.set(c[c.length-2],c[c.length-1])),m=.5*(t.x+p.x),p=.5*(p.y+t.y),c.unshift(m,p),c.push(m,p)),g),y=c.length/2;let r=c.length;var b=v.length/2,S=_.width/2,w=S*S,T=_.miterLimit*_.miterLimit;let i=c[0],s=c[1],a=c[2],n=c[3],o=0,h=0,l=-(s-n),u=i-a;var M=0,P=0;let d=Math.sqrt(l*l+u*u);l/=d,u/=d,l*=S,u*=S;var C=2*(1-e),k=2*e;f||("round"===_.cap?r+=N(i-l*(C-k)*.5,s-u*(C-k)*.5,i-l*C,s-u*C,i+l*k,s+u*k,v,!0)+2:"square"===_.cap&&(r+=V(i,s,l,u,C,k,!0,v))),v.push(i-l*C,s-u*C),v.push(i+l*k,s+u*k);for(let t=1;t<y-1;++t){i=c[2*(t-1)],s=c[2*(t-1)+1],a=c[2*t],n=c[2*t+1],o=c[2*(t+1)],h=c[2*(t+1)+1],l=-(s-n),u=i-a,d=Math.sqrt(l*l+u*u),l/=d,u/=d,l*=S,u*=S,M=-(n-h),P=a-o;var A,B,R,z,M=M/(d=Math.sqrt(M*M+P*P))*S,P=P/d*S,F=a-i,I=s-n,U=a-o,E=h-n,W=F*U+I*E,O=I*U-E*F,G=O<0;Math.abs(O)<.001*Math.abs(W)?(v.push(a-l*C,n-u*C),v.push(a+l*k,n+u*k),0<=W&&("round"===_.join?r+=N(a,n,a-l*C,n-u*C,a-M*C,n-P*C,v,!1)+4:r+=2,v.push(a-M*k,n-P*k),v.push(a+M*C,n+P*C))):(R=(E*(W=(-l+i)*(-u+n)-(-l+a)*(-u+s))-I*(B=(-M+o)*(-P+n)-(-M+a)*(-P+h)))/O,W=((B=(F*B-U*W)/O)-a)*(B-a)+(R-n)*(R-n),O=a+(B-a)*C,A=n+(R-n)*C,B=a-(B-a)*k,R=n-(R-n)*k,z=G?C:k,W<=Math.min(F*F+I*I,U*U+E*E)+z*z*w?"bevel"===_.join||T<W/w?(G?(v.push(O,A),v.push(a+l*k,n+u*k),v.push(O,A),v.push(a+M*k,n+P*k)):(v.push(a-l*C,n-u*C),v.push(B,R),v.push(a-M*C,n-P*C),v.push(B,R)),r+=2):"round"===_.join?G?(v.push(O,A),v.push(a+l*k,n+u*k),r+=N(a,n,a+l*k,n+u*k,a+M*k,n+P*k,v,!0)+4,v.push(O,A),v.push(a+M*k,n+P*k)):(v.push(a-l*C,n-u*C),v.push(B,R),r+=N(a,n,a-l*C,n-u*C,a-M*C,n-P*C,v,!1)+4,v.push(a-M*C,n-P*C),v.push(B,R)):(v.push(O,A),v.push(B,R)):(v.push(a-l*C,n-u*C),v.push(a+l*k,n+u*k),"round"===_.join?r+=G?N(a,n,a+l*k,n+u*k,a+M*k,n+P*k,v,!0)+2:N(a,n,a-l*C,n-u*C,a-M*C,n-P*C,v,!1)+2:"miter"===_.join&&W/w<=T&&(G?(v.push(B,R),v.push(B,R)):(v.push(O,A),v.push(O,A)),r+=2),v.push(a-M*C,n-P*C),v.push(a+M*k,n+P*k),r+=2))}i=c[2*(y-2)],s=c[2*(y-2)+1],a=c[2*(y-1)],n=c[2*(y-1)+1],l=-(s-n),u=i-a,d=Math.sqrt(l*l+u*u),l/=d,u/=d,l*=S,u*=S,v.push(a-l*C,n-u*C),v.push(a+l*k,n+u*k),f||("round"===_.cap?r+=N(a-l*(C-k)*.5,n-u*(C-k)*.5,a-l*C,n-u*C,a+l*k,n+u*k,v,!1)+2:"square"===_.cap&&(r+=V(a,n,l,u,C,k,!1,v)));var D=H*H;for(let t=b;t<r+b-2;++t)i=v[2*t],s=v[2*t+1],a=v[2*(t+1)],n=v[2*(t+1)+1],o=v[2*(t+2)],h=v[2*(t+2)+1],Math.abs(i*(n-h)+a*(h-s)+o*(s-n))<D||x.push(t,t+1,t+2)}}var C=e(6570);function $(r,t,i,s,a,n,o){var h=C(r,t,2);if(h){for(let t=0;t<h.length;t+=3)n[o++]=h[t]+a,n[o++]=h[t+1]+a,n[o++]=h[t+2]+a;let e=a*s;for(let t=0;t<r.length;t+=2)i[e]=r[t],i[e+1]=r[t+1],e+=s}}const k=[];const X={rectangle:{build(t,e){var r=t.x,i=t.y,s=t.width,t=t.height;return 0<=s&&0<=t&&(e[0]=r,e[1]=i,e[2]=r+s,e[3]=i,e[4]=r+s,e[5]=i+t,e[6]=r,e[7]=i+t),e},triangulate(t,e,r,i,s,a){var n=0,e=(e[(i*=r)+0]=t[0],e[i+0+1]=t[1],e[i+(n+=r)]=t[2],e[i+n+1]=t[3],e[i+(n+=r)]=t[6],e[i+n+1]=t[7],e[i+(n+=r)]=t[4],e[i+n+1]=t[5],i/r);s[a++]=e,s[a++]=1+e,s[a++]=2+e,s[a++]=1+e,s[a++]=3+e,s[a++]=2+e}},polygon:{build(e,r){for(let t=0;t<e.points.length;t++)r[t]=e.points[t];return r},triangulate(t,e,r,i,s,a){$(t,k,e,r,i,s,a)}},triangle:{build(t,e){return e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e},triangulate(t,e,r,i,s,a){var n=0,e=(e[(i*=r)+0]=t[0],e[i+0+1]=t[1],e[i+(n+=r)]=t[2],e[i+n+1]=t[3],e[i+(n+=r)]=t[4],e[i+n+1]=t[5],i/r);s[a++]=e,s[a++]=1+e,s[a++]=2+e}},circle:w,ellipse:w,roundedRectangle:w},A=new s.M;function B(e,t){var{geometryData:r,batches:i}=t;i.length=0,r.indices.length=0,r.vertices.length=0;for(let t=r.uvs.length=0;t<e.instructions.length;t++){var s,a,n,o,h,l,u,d,c,p,f,g,x,m=e.instructions[t];"texture"===m.action?(c=d=x=p=f=u=l=h=g=o=n=a=s=void 0,s=m.data,a=i,{vertices:o,uvs:g,indices:h}=n=r,l=h.length,u=o.length/2,f=[],p=X.rectangle,x=A,d=s.image,x.x=s.dx,x.y=s.dy,x.width=s.dw,x.height=s.dh,c=s.transform,p.build(x,f),c&&G(f,c),p.triangulate(f,o,2,u,h,l),x=d.uvs,g.push(x.x0,x.y0,x.x1,x.y1,x.x3,x.y3,x.x2,x.y2),(c=O.Z.get(D.G)).indexOffset=l,c.indexSize=h.length-l,c.vertexOffset=u,c.vertexSize=o.length/2-u,c.color=s.style,c.alpha=s.alpha,c.texture=d,c.geometryData=n,a.push(c)):"fill"!==m.action&&"stroke"!==m.action||(p="stroke"===m.action,f=m.data.path.shapePath,g=m.data.style,x=m.data.hole,p&&x&&T(x.shapePath,g,null,!0,i,r),T(f,g,x,p,i,r))}}function T(t,k,A,B,R,z){const{vertices:F,uvs:I,indices:U}=z,E=t.shapePrimitives.length-1;t.shapePrimitives.forEach(({shape:e,transform:t},r)=>{var i=U.length,s=F.length/2,a=[],n=X[e.type];if(n.build(e,a),t&&G(a,t),B){e=e.closePath??!0;Y(a,k,!1,e,F,0,0,U)}else if(A&&E===r){0!=E&&console.warn("[Pixi Graphics] only the last shape have be cut out");const P=[],C=a.slice();(function(t){if(!t)return[];var e=t.shapePrimitives,r=[];for(let t=0;t<e.length;t++){var i=e[t].shape,s=[];X[i.type].build(i,s),r.push(s)}return r})(A.shapePath).forEach(t=>{P.push(C.length/2),C.push(...t)}),$(C,P,F,2,s,U,i)}else n.triangulate(a,F,2,s,U,i);e=I.length/2,r=k.texture;if(r!==W.g.WHITE){n=k.matrix;t&&n.append(t.clone().invert());{var[o,h,l,u,d,c,p,a=null]=[F,2,s,I,e,2,F.length/2-s,n];let t=0;l*=h,d*=c;for(var f=a.a,g=a.b,x=a.c,m=a.d,_=a.tx,v=a.ty;t<p;){var y=o[l],b=o[l+1];u[d]=f*y+x*b+_,u[d+1]=g*y+m*b+v,d+=c,l+=h,t++}}}else{var S=I;var w=e;var T=2;var M=F.length/2-s;let t=0;for(w*=T;t<M;)S[w]=0,S[w+1]=0,w+=T,t++}t=O.Z.get(D.G);t.indexOffset=i,t.indexSize=U.length-i,t.vertexOffset=s,t.vertexSize=F.length/2-s,t.color=k.color,t.alpha=k.alpha,t.texture=r,t.geometryData=z,R.push(t)})}class R{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class z{constructor(){this.geometry=new o,this.instructions=new S.L}init(){this.instructions.reset()}}const M=class M{constructor(){this._activeBatchers=[],this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._needsContextNeedsRebuild=[]}init(t){M.defaultOptions.bezierSmoothness=t?.bezierSmoothness??M.defaultOptions.bezierSmoothness}prerender(){this._returnActiveBatchers()}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);var r;return t.dirty&&(e?this._cleanGraphicsContextData(t):e=this._initContext(t),B(t,e),r=t.batchMode,t.customShader||"no-batch"===r?e.isBatchable=!1:"auto"===r&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1),e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_returnActiveBatchers(){for(let t=0;t<this._activeBatchers.length;t++)O.Z.return(this._activeBatchers[t]);this._activeBatchers.length=0}_initContextRenderData(t){var e=O.Z.get(z),{batches:r,geometryData:i}=this._gpuContextHash[t.uid],s=i.vertices.length,i=i.indices.length;for(let t=0;t<r.length;t++)r[t].applyTransform=!1;var a=O.Z.get(b);this._activeBatchers.push(a),a.ensureAttributeBuffer(s),a.ensureIndexBuffer(i),a.begin();for(let t=0;t<r.length;t++){var n=r[t];a.add(n)}a.finish(e.instructions);var s=e.geometry,o=(s.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),s.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0),a.batches);for(let t=0;t<o.length;t++){var h=o[t];h.bindGroup=u(h.textures.textures,h.textures.count)}return this._graphicsDataContextHash[t.uid]=e}_initContext(t){var e=new R;return this._gpuContextHash[t.uid]=e,t.on("update",this.onGraphicsContextUpdate,this),t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextUpdate(t){this._needsContextNeedsRebuild.push(t)}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("update",this.onGraphicsContextUpdate,this),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){var e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(O.Z.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(t=>{O.Z.return(t)})}destroy(){for(const t of this._needsContextNeedsRebuild)this._gpuContextHash[t.uid]&&this.onGraphicsContextDestroy(t);this._needsContextNeedsRebuild.length=0}};M.extension={type:[t.Ag.WebGLSystem,t.Ag.WebGPUSystem,t.Ag.CanvasSystem],name:"graphicsContext"},M.defaultOptions={bezierSmoothness:.5};let F=M},7276:(t,e,r)=>{"use strict";r.d(e,{_:()=>a});var i=r(2577),u=r(1761),d=r(9313),c=r(8293),p=r(7174),s=r(133);const f=class f{constructor(t,e,r,i){this.uid=(0,s.L)("fillGradient"),this.type="linear",this.gradientStops=[],this.x0=t,this.y0=e,this.x1=r,this.y1=i}addColorStop(t,e){return this.gradientStops.push({offset:t,color:i.Q.shared.setValue(e).toHex()}),this}buildLinearGradient(){var t=f.defaultTextureSize,e=this["gradientStops"],r=u.e.get().createCanvas(),i=(r.width=t,r.height=t,r.getContext("2d")),s=i.createLinearGradient(0,0,f.defaultTextureSize,1);for(let t=0;t<e.length;t++){var a=e[t];s.addColorStop(a.offset,a.color)}i.fillStyle=s,i.fillRect(0,0,t,t),this.texture=new p.g({source:new c.b({resource:r,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});var{x0:i,y0:r,x1:n,y1:o}=this,h=new d.u,n=n-i,o=o-r,l=Math.sqrt(n*n+o*o),o=Math.atan2(o,n);h.translate(-i,-r),h.scale(1/t,1/t),h.rotate(-o),h.scale(256/l,1),this.transform=h}};f.defaultTextureSize=256;let a=f},2806:(t,e,r)=>{"use strict";r.d(e,{m:()=>n});var i=r(9313),s=r(133);const a={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class n{constructor(t,e){this.uid=(0,s.L)("fillPattern"),this.transform=new i.u,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=a[e].addressModeU,t.source.style.addressModeV=a[e].addressModeV)}setTransform(t){var e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height)}}},990:(t,e,r)=>{"use strict";r.d(e,{M:()=>function(t,e){if(null==t)return null;let r,i;r=t?.fill?(i=t.fill,{...e,...t}):(i=t,e);{var s;if(n.Q.isColorLike(i))return s=n.Q.shared.setValue(i??0),{...r,color:s.toNumber(),alpha:(1===s.alpha?r:s).alpha,texture:h.g.WHITE};if(i instanceof u.m)return s=i,{...r,color:16777215,texture:s.texture,matrix:s.transform,fill:r.fill??null};if(i instanceof l._)return(a=i).buildLinearGradient(),{...r,color:16777215,texture:a.texture,matrix:a.transform}}var a={...e,...t};a.texture&&(a.texture!==h.g.WHITE&&((e=a.matrix?.invert()||new o.u).scale(1/a.texture.frame.width,1/a.texture.frame.height),a.matrix=e),"clamp-to-edge"===(t=a.texture.source.style).addressMode)&&(t.addressMode="repeat");e=n.Q.shared.setValue(a.color);return a.alpha*=e.alpha,a.color=e.toNumber(),a.matrix=a.matrix?a.matrix.clone():null,a}});var n=r(2577),o=r(9313),h=r(7174),l=r(7276),u=r(2806)},5285:(t,e,r)=>{"use strict";var i=r(8507),s=r(9313),a=r(3513),n=r(7222),o=r(8218),h=r(2760),l=r(8734);class u{constructor(t,e){this.localUniforms=new n.k({uTransformMatrix:{value:new s.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new a.T({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){var e=this._getMeshData(t),r=e.batched,i=t.batched;if(r!==(e.batched=i))return!0;if(i){r=t._geometry;if(r.indices.length!==e.indexSize||r.positions.length!==e.vertexSize)return e.indexSize=r.indices.length,e.vertexSize=r.positions.length,!0;i=this._getBatchableMesh(t),e=t.texture;if(i.texture._source!==e._source&&i.texture._source!==e._source)return!i.batcher.checkAndUpdateTexture(i,e)}return!1}addRenderable(t,e){var r=this.renderer.renderPipes.batch,i=this._getMeshData(t)["batched"];i?((i=this._getBatchableMesh(t)).texture=t._texture,i.geometry=t._geometry,r.addToBatch(i)):(r.break(e),e.add({renderPipeId:"mesh",mesh:t}))}updateRenderable(t){var e;t.batched&&((e=this._gpuBatchableMeshHash[t.uid]).texture=t._texture,e.geometry=t._geometry,e.batcher.updateElement(e))}destroyRenderable(t){this._meshDataHash[t.uid]=null;var e=this._gpuBatchableMeshHash[t.uid];e&&(o.Z.return(e),this._gpuBatchableMeshHash[t.uid]=null)}execute({mesh:t}){var e;t.isRenderable&&(t.state.blendMode=t.groupBlendMode,(e=this.localUniforms).uniforms.uTransformMatrix=t.groupTransform,e.uniforms.uRound=this.renderer._roundPixels|t._roundPixels,e.update(),(0,h.V)(t.groupColorAlpha,e.uniforms.uColor,0),this._adaptor.execute(this,t))}_getMeshData(t){return this._meshDataHash[t.uid]||this._initMeshData(t)}_initMeshData(t){return this._meshDataHash[t.uid]={batched:t.batched,indexSize:t._geometry.indices?.length,vertexSize:t._geometry.positions?.length},t.on("destroyed",()=>{this.destroyRenderable(t)}),this._meshDataHash[t.uid]}_getBatchableMesh(t){return this._gpuBatchableMeshHash[t.uid]||this._initBatchableMesh(t)}_initBatchableMesh(t){var e=o.Z.get(l.U);return e.mesh=t,e.texture=t._texture,e.roundPixels=this.renderer._roundPixels|t._roundPixels,(this._gpuBatchableMeshHash[t.uid]=e).mesh=t,e}destroy(){for(const t in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[t]&&o.Z.return(this._gpuBatchableMeshHash[t]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}u.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"mesh"},i.XO.add(u)},8734:(t,e,r)=>{"use strict";r.d(e,{U:()=>i});class i{constructor(){this.batcher=null,this.batch=null,this.roundPixels=0,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get blendMode(){return this.mesh.groupBlendMode}reset(){this.mesh=null,this.texture=null,this.batcher=null,this.batch=null}packIndex(e,r,i){var s=this.geometry.indices;for(let t=0;t<s.length;t++)e[r++]=s[t]+i}packAttributes(e,r,i,t){var s=this.mesh,a=this.geometry,n=s.groupTransform,o=t<<16|65535&this.roundPixels,h=n.a,l=n.b,u=n.c,d=n.d,c=n.tx,p=n.ty,f=a.positions,t=a.getBuffer("aUV"),n=t.data;let g=n;var a=this.texture.textureMatrix,x=(a.isSimple||(g=this._transformedUvs,this._textureMatrixUpdateId===a._updateID&&this._uvUpdateId===t._updateID)||((!g||g.length<n.length)&&(g=this._transformedUvs=new Float32Array(n.length)),this._textureMatrixUpdateId=a._updateID,this._uvUpdateId=t._updateID,a.multiplyUvs(n,g)),s.groupColorAlpha);for(let t=0;t<f.length;t+=2){var m=f[t],_=f[t+1];e[i]=h*m+u*_+c,e[i+1]=l*m+d*_+p,e[i+2]=g[t],e[i+3]=g[t+1],r[i+4]=x,r[i+5]=o,i+=6}}get vertexSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}},5060:(t,e,r)=>{"use strict";r.d(e,{u:()=>i});var a=r(949),n=r(1132),e=r(6011),o=r(4670);const h=class h extends e.V{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&((0,o.t)(o.l,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]});var t=(e={...h.defaultOptions,...e}).positions||new Float32Array([0,0,1,0,1,1,0,1]),r=e.uvs||new Float32Array([0,0,1,0,1,1,0,1]),i=e.indices||new Uint32Array([0,1,2,0,2,3]),s=e.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new a.h({data:t,label:"attribute-mesh-positions",shrinkToFit:s,usage:n.S.VERTEX|n.S.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new a.h({data:r,label:"attribute-mesh-uvs",shrinkToFit:s,usage:n.S.VERTEX|n.S.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new a.h({data:i,label:"index-mesh-buffer",shrinkToFit:s,usage:n.S.INDEX|n.S.COPY_DST}),topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};h.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let i=h},7252:(t,e,r)=>{"use strict";var i=r(8507),s=r(8218),a=r(8734),n=r(4670);const m=class m extends r(5060).u{constructor(...t){super({});let e=t[0]??{};"number"==typeof e&&((0,n.t)(n.l,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(t){t={...m.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;var e=this.verticesX*this.verticesY,r=[],i=[],s=[],a=this.verticesX-1,n=this.verticesY-1,o=this.width/a,h=this.height/n;for(let t=0;t<e;t++){var l=t%this.verticesX,u=t/this.verticesX|0;r.push(l*o,u*h),i.push(l/a,u/n)}var d=a*n;for(let t=0;t<d;t++){var c=t%a,p=t/a|0,f=p*this.verticesX+c,g=p*this.verticesX+c+1,x=(1+p)*this.verticesX+c,p=(1+p)*this.verticesX+c+1;s.push(f,g,x,g,p,x)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint32Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}},o=(m.defaultOptions={width:100,height:100,verticesX:10,verticesY:10},class o extends m{constructor(t={}){super({width:(t={...o.defaultOptions,...t}).width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(t){this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){var t=this.positions,e=this._leftWidth+this._rightWidth,e=this.width>e?1:this.width/e,r=this._topHeight+this._bottomHeight,r=this.height>r?1:this.height/r,e=Math.min(e,r);t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){var t=this.uvs,e=(t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,(t[25]=t[27]=t[29]=t[31]=1)/this._originalWidth),r=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.getBuffer("aUV").update()}});o.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let h=o;class l{constructor(t){this._gpuSpriteHash=Object.create(null),this._renderer=t}addRenderable(t,e){var r=this._getGpuSprite(t);t._didSpriteUpdate&&this._updateBatchableSprite(t,r),this._renderer.renderPipes.batch.addToBatch(r)}updateRenderable(t){var e=this._gpuSpriteHash[t.uid];t._didSpriteUpdate&&this._updateBatchableSprite(t,e),e.batcher.updateElement(e)}validateRenderable(t){var e=t._texture,t=this._getGpuSprite(t);return t.texture._source!==e._source&&!t.batcher.checkAndUpdateTexture(t,e)}destroyRenderable(t){var e=this._gpuSpriteHash[t.uid];s.Z.return(e),this._gpuSpriteHash[t.uid]=null}_updateBatchableSprite(t,e){t._didSpriteUpdate=!1,e.geometry.update(t),e.texture=t._texture}_getGpuSprite(t){return this._gpuSpriteHash[t.uid]||this._initGPUSprite(t)}_initGPUSprite(t){var e=new a.U;return e.geometry=new h,e.mesh=t,e.texture=t._texture,e.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuSpriteHash[t.uid]=e,t.on("destroyed",()=>{this.destroyRenderable(t)}),e}destroy(){for(const t in this._gpuSpriteHash)this._gpuSpriteHash[t].geometry.destroy();this._gpuSpriteHash=null,this._renderer=null}}l.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"nineSliceSprite"},i.XO.add(l)},3830:(t,e,r)=>{"use strict";var i=r(8507),s=r(7547),a=r(5099),n=r(2760),o=r(8734),h=r(5060),b=r(9313),l=r(5611);const u={name:"local-uniform-bit",vertex:{header:`

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `}};({...u,vertex:{...u.vertex,header:u.vertex.header.replace("group(1)","group(2)")}});const d={name:"local-uniform-bit",vertex:{header:`

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `}};var c=r(6665),p=r(8475),f=r(7222),g=r(7174);const x={name:"tiling-bit",vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            } 

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},m={name:"tiling-bit",vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;
        
        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);
        
        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0
    
        `}};let _,v;class y extends p.M{constructor(){_=_??(0,l.v)({name:"tiling-sprite-shader",bits:[u,x,c.b]}),v=v??(0,l.I)({name:"tiling-sprite-shader",bits:[d,m,c.m]});var t=new f.k({uMapCoord:{value:new b.u,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new b.u,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:v,gpuProgram:_,resources:{localUniforms:new f.k({uTransformMatrix:{value:new b.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:t,uTexture:g.g.EMPTY.source,uSampler:g.g.EMPTY.source.style}})}updateUniforms(t,e,r,i,s,a){var n=this.resources.tilingUniforms,o=a.width,h=a.height,l=a.textureMatrix,u=n.uniforms.uTextureTransform;u.set(r.a*o/t,r.b*o/e,r.c*h/t,r.d*h/e,r.tx/t,r.ty/e),u.invert(),n.uniforms.uMapCoord=l.mapCoord,n.uniforms.uClampFrame=l.uClampFrame,n.uniforms.uClampOffset=l.uClampOffset,n.uniforms.uTextureTransform=u,n.uniforms.uSizeAnchor[0]=t,n.uniforms.uSizeAnchor[1]=e,n.uniforms.uSizeAnchor[2]=i,n.uniforms.uSizeAnchor[3]=s,a&&(this.resources.uTexture=a.source,this.resources.uSampler=a.source.style)}}class S extends h.u{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}const w=new S;class T{constructor(t){this._tilingSpriteDataHash=Object.create(null),this._renderer=t}validateRenderable(t){var e=this._getTilingSpriteData(t),r=e.canBatch,i=(this._updateCanBatch(t),e.canBatch);if(i&&i===r){e=e["batchableMesh"];if(e.texture._source!==t.texture._source)return!e.batcher.checkAndUpdateTexture(e,t.texture)}return r!==i}addRenderable(t,e){var r=this._renderer.renderPipes.batch,i=(this._updateCanBatch(t),this._getTilingSpriteData(t)),{geometry:s,canBatch:a}=i;a?(i.batchableMesh||(i.batchableMesh=new o.U),a=i.batchableMesh,t._didTilingSpriteUpdate&&(t._didTilingSpriteUpdate=!1,this._updateBatchableMesh(t),a.geometry=s,a.mesh=t,a.texture=t._texture),a.roundPixels=this._renderer._roundPixels|t._roundPixels,r.addToBatch(a)):(r.break(e),i.shader||(i.shader=new y),this.updateRenderable(t),e.add(t))}execute(t){var e=this._tilingSpriteDataHash[t.uid]["shader"],r=(e.groups[0]=this._renderer.globalUniforms.bindGroup,e.resources.localUniforms.uniforms);r.uTransformMatrix=t.groupTransform,r.uRound=this._renderer._roundPixels|t._roundPixels,(0,n.V)(t.groupColorAlpha,r.uColor,0),this._renderer.encoder.draw({geometry:w,shader:e,state:s.U.default2d})}updateRenderable(t){var e=this._getTilingSpriteData(t),r=e["canBatch"];r?(r=e["batchableMesh"],t._didTilingSpriteUpdate&&this._updateBatchableMesh(t),r.batcher.updateElement(r)):t._didTilingSpriteUpdate&&(r=e["shader"],r.updateUniforms(t.width,t.height,t._tileTransform.matrix,t.anchor.x,t.anchor.y,t.texture)),t._didTilingSpriteUpdate=!1}destroyRenderable(t){var e=this._getTilingSpriteData(t);e.batchableMesh=null,e.shader?.destroy(),this._tilingSpriteDataHash[t.uid]=null}_getTilingSpriteData(t){return this._tilingSpriteDataHash[t.uid]||this._initTilingSpriteData(t)}_initTilingSpriteData(t){var e=new h.u({indices:w.indices,positions:w.positions.slice(),uvs:w.uvs.slice()});return this._tilingSpriteDataHash[t.uid]={canBatch:!0,renderable:t,geometry:e},t.on("destroyed",()=>{this.destroyRenderable(t)}),this._tilingSpriteDataHash[t.uid]}_updateBatchableMesh(r){var i=this._getTilingSpriteData(r)["geometry"],s=r.texture.source.style;"repeat"!==s.addressMode&&(s.addressMode="repeat",s.update());{var s=r,a=i.uvs,n=(o=s.texture).frame.width,o=o.frame.height;let t=0,e=0;s._applyAnchorToTexture&&(t=s.anchor.x,e=s.anchor.y),a[0]=a[6]=-t,a[2]=a[4]=1-t,a[1]=a[3]=-e,a[5]=a[7]=1-e;var h=b.u.shared;h.copyFrom(s._tileTransform.matrix),h.tx/=s.width,h.ty/=s.height,h.invert(),h.scale(s.width/n,s.height/o);{var l=a,u=2,d=0;n=h;let t=0;var c=l.length/(u||2),p=n.a,f=n.b,g=n.c,x=n.d,m=n.tx,_=n.ty;for(d*=u;t<c;){var v=l[d],y=l[d+1];l[d]=p*v+g*y+m,l[d+1]=f*v+x*y+_,d+=u,t++}}}s=r,o=i.positions,a=s.anchor.x,h=s.anchor.y,o[0]=-a*s.width,o[1]=-h*s.height,o[2]=(1-a)*s.width,o[3]=-h*s.height,o[4]=(1-a)*s.width,o[5]=(1-h)*s.height,o[6]=-a*s.width,o[7]=(1-h)*s.height}destroy(){for(const t in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[t].renderable);this._tilingSpriteDataHash=null,this._renderer=null}_updateCanBatch(t){var e=this._getTilingSpriteData(t),t=t.texture;let r=!0;return this._renderer.type===a.W.WEBGL&&(r=this._renderer.context.supports.nonPowOf2wrapping),e.canBatch=t.textureMatrix.isSimple&&(r||t.source.isPowerOfTwo),e.canBatch}}T.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"tilingSprite"},i.XO.add(T)},8422:(t,e,r)=>{"use strict";r.d(e,{K:()=>i});class i{constructor(){this.vertexSize=4,this.indexSize=6,this.location=0,this.batcher=null,this.batch=null,this.roundPixels=0}get blendMode(){return this.renderable.groupBlendMode}packAttributes(t,e,r,i){var s=this.renderable,a=this.texture,n=s.groupTransform,o=n.a,h=n.b,l=n.c,u=n.d,d=n.tx,n=n.ty,c=this.bounds,p=c.maxX,f=c.minX,g=c.maxY,c=c.minY,a=a.uvs,s=s.groupColorAlpha,i=i<<16|65535&this.roundPixels;t[r+0]=o*f+l*c+d,t[r+1]=u*c+h*f+n,t[r+2]=a.x0,t[r+3]=a.y0,e[r+4]=s,e[r+5]=i,t[r+6]=o*p+l*c+d,t[r+7]=u*c+h*p+n,t[r+8]=a.x1,t[r+9]=a.y1,e[r+10]=s,e[r+11]=i,t[r+12]=o*p+l*g+d,t[r+13]=u*g+h*p+n,t[r+14]=a.x2,t[r+15]=a.y2,e[r+16]=s,e[r+17]=i,t[r+18]=o*f+l*g+d,t[r+19]=u*g+h*f+n,t[r+20]=a.x3,t[r+21]=a.y3,e[r+22]=s,e[r+23]=i}packIndex(t,e,r){t[e]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3}reset(){this.renderable=null,this.texture=null,this.batcher=null,this.batch=null,this.bounds=null}}},4481:(E,W,t)=>{"use strict";var e=t(8507),r=t(4589),O=t(2233),i=t(1761),h=t(2927),v=t(9252),y=t(7174),s=t(4486),a=t(4670);class n extends s.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,a.t)(a.l,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,a.t)(a.l,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,a.t)(a.l,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,a.t)(a.l,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,a.t)(a.l,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const e in this.chars)this.chars[e].texture.destroy();this.chars=null,t&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}var o=t(1979),l=t(8291),G=t(2577),u=t(7608),D=t(8293),b=t(4016),d=t(1242),c=t(3548);function S(r){if(""===r)return[];var i=[];for(let t=0,e=(r="string"==typeof r?[r]:r).length;t<e;t++){var s=r[t];if(Array.isArray(s)){if(2!==s.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(0===s[0].length||0===s[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");var a=s[0].charCodeAt(0),n=s[1].charCodeAt(0);if(n<a)throw new Error("[BitmapFont]: Invalid character range.");for(let t=a,e=n;t<=e;t++)i.push(String.fromCharCode(t))}else i.push(...Array.from(s))}if(0===i.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return i}class p extends n{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=4,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;var e=t.style.clone(),r=(t.overrideFill&&(e._fill.color=16777215,e._fill.alpha=1,e._fill.texture=y.g.WHITE,e._fill.fill=null),e.fontSize),i=(e.fontSize=this.baseMeasurementFontSize,(0,d.Z)(e));t.overrideSize?e._stroke&&(e._stroke.width*=this.baseRenderedFontSize/r):e.fontSize=this.baseRenderedFontSize=r,this._style=e,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,this.fontMetrics=b.P.measureFont(i),this.lineHeight=e.lineHeight||this.fontMetrics.fontSize||e.fontSize}ensureCharacters(t){var h=S(t).filter(t=>!this._currentChars.includes(t)).filter((t,e,r)=>r.indexOf(t)===e);if(h.length){this._currentChars=[...this._currentChars,...h];let t,{canvas:e,context:r}=(t=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex]).canvasAndContext,i=t.texture.source;var l=this._style;let s=this._currentX,a=this._currentY;var u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u,c="italic"===l.fontStyle?2:1;let n=0,o=!1;for(let t=0;t<h.length;t++){var p=h[t],f=b.P.measureText(p,l,e,!1),g=(f.lineHeight=f.height,c*f.width*u),x=g+2*d,m=f.height*u+2*d,_=(o=!1,"\n"!==p&&"\r"!==p&&"\t"!==p&&" "!==p&&(o=!0,n=Math.ceil(Math.max(m,n))),512<s+x&&(a+=n,n=m,s=0,512<a+n)&&(i.update(),_=this._nextPage(),e=_.canvasAndContext.canvas,r=_.canvasAndContext.context,i=_.texture.source,a=0),g/u-(l.dropShadow?.distance??0)-(l._stroke?.width??0));this.chars[p]={id:p.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:_,kerning:{}},o&&(this._drawGlyph(r,f,s+d,a+d,u,l),g=i.width*u,f=i.height*u,g=new v.M(s/g*i.width,a/f*i.height,x/g*i.width,m/f*i.height),this.chars[p].texture=new y.g({source:i,frame:g}),s+=Math.ceil(x))}i.update(),this._currentX=s,this._currentY=a,this._skipKerning&&this._applyKerning(h,r)}}get pageTextures(){return(0,a.t)(a.l,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,i){var s=this._measureCache;for(let t=0;t<e.length;t++){var a=e[t];for(let r=0;r<this._currentChars.length;r++){var n=this._currentChars[r];let t=s[a],e=(t=t||(s[a]=i.measureText(a).width),s[n]);e=e||(s[n]=i.measureText(n).width);var o=i.measureText(a+n).width-(t+e);o&&(this.chars[a].kerning[n]=o),(o=i.measureText(a+n).width-(t+e))&&(this.chars[n].kerning[a]=o)}}}_nextPage(){this._currentPageIndex++;var t=this.resolution,e=u.N.getOptimalCanvasAndContext(512,512,t),t=(this._setupContext(e.context,this._style,t),t*(this.baseRenderedFontSize/this.baseMeasurementFontSize)),e={canvasAndContext:e,texture:new y.g({source:new D.b({resource:e.canvas,resolution:t,alphaMode:"premultiply-alpha-on-upload"})})};return this.pages[this._currentPageIndex]=e}_setupContext(t,e,r){e.fontSize=this.baseRenderedFontSize,t.scale(r,r),t.font=(0,d.Z)(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;var i=e._stroke,s=i?.width??0;i&&(t.lineWidth=s,t.lineJoin=i.join,t.miterLimit=i.miterLimit,t.strokeStyle=(0,c.r)(i,t)),e._fill&&(t.fillStyle=(0,c.r)(e._fill,t)),e.dropShadow?(s=e.dropShadow,i=G.Q.shared.setValue(s.color).toArray(),e=s.blur*r,r=s.distance*r,t.shadowColor=`rgba(${255*i[0]},${255*i[1]},${255*i[2]},${s.alpha})`,t.shadowBlur=e,t.shadowOffsetX=Math.cos(s.angle)*r,t.shadowOffsetY=Math.sin(s.angle)*r):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}_drawGlyph(t,e,r,i,s,a){var n=e.text,o=e.fontProperties,h=(a._stroke?.width??0)*s,r=r+h/2,i=i-h/2,o=o.descent*s,e=e.lineHeight*s;a.stroke&&h&&t.strokeText(n,r,i+e-o),a._fill&&t.fillText(n,r,i+e-o)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){var{canvasAndContext:e,texture:r}=this.pages[t];u.N.returnCanvasAndContext(e),r.destroy(!0)}this.pages=null}}function f(r,i,s){const a={width:0,height:0,offsetY:0,scale:i.fontSize/s.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};a.offsetY=s.baseLineOffset;let n=a.lines[0],o=null,h=!0;const l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]};var u=e=>{var r=n.width;for(let t=0;t<l.index;t++){var i=e.positions[t];n.chars.push(e.chars[t]),n.charPositions.push(i+r)}n.width+=e.width,h=!1,l.width=0,l.index=0,l.chars.length=0},d=()=>{let t=n.chars.length-1,e=n.chars[t];for(;" "===e;)n.width-=s.chars[e].xAdvance,e=n.chars[--t];a.width=Math.max(a.width,n.width),n={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},h=!0,a.lines.push(n),a.height+=s.lineHeight},t=s.baseMeasurementFontSize/i.fontSize,c=i.letterSpacing*t,p=i.wordWrapWidth*t;for(let e=0;e<r.length+1;e++){let t;var f=e===r.length,g=(f||(t=r[e]),s.chars[t]||s.chars[" "]);/(?:\s)/.test(t)||"\r"===t||"\n"===t||f?(!h&&i.wordWrap&&n.width+l.width-c>p?d():l.start=n.width,u(l),f||n.charPositions.push(0),"\r"===t||"\n"===t?0!==n.width&&d():f||(f=g.xAdvance+(g.kerning[o]||0)+c,n.width+=f,n.spaceWidth=f,n.spacesIndex.push(n.charPositions.length),n.chars.push(t))):(f=g.kerning[o]||0,g=g.xAdvance+f+c,l.positions[l.index++]=l.width+f,l.chars.push(t),l.width+=g),o=t}if(d(),"center"===i.align){var e=a;for(let t=0;t<e.lines.length;t++){var x=e.lines[t],m=e.width/2-x.width/2;for(let t=0;t<x.charPositions.length;t++)x.charPositions[t]+=m}}else if("right"===i.align){var _=a;for(let t=0;t<_.lines.length;t++){var v=_.lines[t],y=_.width-v.width;for(let t=0;t<v.charPositions.length;t++)v.charPositions[t]+=y}}else if("justify"===i.align){var b=a,S=b.width;for(let t=0;t<b.lines.length;t++){var w=b.lines[t];let e=0,r=w.spacesIndex[e++],i=0;var T=w.spacesIndex.length,M=(S-w.width)/T;for(let t=0;t<w.charPositions.length;t++)t===r&&(r=w.spacesIndex[e++],i+=M),w.charPositions[t]+=i}}return a}const g=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){let r=e.fontFamily+"-bitmap",i=!0;e._fill.fill&&(r+=e._fill.fill.uid,i=!1),o.l.has(r)||((e=new p({style:e,overrideFill:i,overrideSize:!0,...this.defaultOptions})).once("destroy",()=>o.l.remove(r)),o.l.set(r,e));e=o.l.get(r);return e.ensureCharacters?.(t),e}getLayout(t,e){var r=this.getFont(t,e);return f(t.split(""),e,r)}measureText(t,e){return this.getLayout(t,e)}install(...t){let e=t[0];"string"==typeof e&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},(0,a.t)(a.l,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const r=e?.name;var i;if(r)return i=null!==(t=(t=(e={...this.defaultOptions,...e}).style)instanceof l.x?t:new l.x(t))._fill.fill&&void 0!==t._fill.fill,t=new p({style:t,overrideFill:i,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),i=S(e.chars),t.ensureCharacters(i.join("")),o.l.set(r+"-bitmap",t),t.once("destroy",()=>o.l.remove(r+"-bitmap")),t;throw new Error("[BitmapFontManager] Property `name` is required.")}uninstall(t){var t=t+"-bitmap",e=o.l.get(t);e&&(o.l.remove(t),e.destroy())}};class x extends n{constructor(t,e){super();const{textures:s,data:a}=t;Object.keys(a.pages).forEach(t=>{t=a.pages[parseInt(t,10)],t=s[t.id];this.pages.push({texture:t})}),Object.keys(a.chars).forEach(t=>{var e=a.chars[t],{frame:r,source:i}=s[e.page],r=new v.M(e.x+r.x,e.y+r.y,e.width,e.height),i=new y.g({source:i,frame:r});this.chars[t]={id:t.codePointAt(0),xOffset:e.xOffset,yOffset:e.yOffset,xAdvance:e.xAdvance,kerning:e.kerning??{},texture:i}}),this.baseRenderedFontSize=a.fontSize,this.baseMeasurementFontSize=a.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:a.fontSize},this.baseLineOffset=a.baseLineOffset,this.lineHeight=a.lineHeight,this.fontFamily=a.fontFamily,this.distanceField=a.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){var e=this.pages[t]["texture"];e.destroy(!0)}this.pages=null}static install(t){g.install(t)}static uninstall(t){g.uninstall(t)}}const m={test(t){return"string"==typeof t&&t.startsWith("info face=")},parse(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const b in e){var i=e[b].match(/^[a-z]+/gm)[0],s=e[b].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(const S in s){var n=s[S].split("="),o=n[0],n=n[1].replace(/"/gm,""),h=parseFloat(n),n=isNaN(h)?n:h;a[o]=n}r[i].push(a)}var l={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[t]=r.info,[u]=r.common,[d]=r.distanceField??[],c=(d&&(l.distanceField={range:parseInt(d.distanceRange,10),type:d.fieldType}),l.fontSize=parseInt(t.size,10),l.fontFamily=t.face,l.lineHeight=parseInt(u.lineHeight,10),r.page);for(let t=0;t<c.length;t++)l.pages.push({id:parseInt(c[t].id,10)||0,file:c[t].file});var p={},f=(l.baseLineOffset=l.lineHeight-parseInt(u.base,10),r.char);for(let e=0;e<f.length;e++){var g=f[e],x=parseInt(g.id,10);let t=g.letter??g.char??String.fromCharCode(x);"space"===t&&(t=" "),p[x]=t,l.chars[t]={id:x,page:parseInt(g.page,10)||0,x:parseInt(g.x,10),y:parseInt(g.y,10),width:parseInt(g.width,10),height:parseInt(g.height,10),xOffset:parseInt(g.xoffset,10),yOffset:parseInt(g.yoffset,10),xAdvance:parseInt(g.xadvance,10),kerning:{}}}var m=r.kerning||[];for(let t=0;t<m.length;t++){var _=parseInt(m[t].first,10),v=parseInt(m[t].second,10),y=parseInt(m[t].amount,10);l.chars[p[v]].kerning[p[_]]=y}return l}},_={test(t){return"string"!=typeof t&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},parse(t){var r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=t.getElementsByTagName("info")[0],i=t.getElementsByTagName("common")[0],s=t.getElementsByTagName("distanceField")[0],a=(s&&(r.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)}),t.getElementsByTagName("page")),n=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");r.fontSize=parseInt(e.getAttribute("size"),10),r.fontFamily=e.getAttribute("face"),r.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let t=0;t<a.length;t++)r.pages.push({id:parseInt(a[t].getAttribute("id"),10)||0,file:a[t].getAttribute("file")});var h={};r.baseLineOffset=r.lineHeight-parseInt(i.getAttribute("base"),10);for(let e=0;e<n.length;e++){var l=n[e],u=parseInt(l.getAttribute("id"),10);let t=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(u);"space"===t&&(t=" "),h[u]=t,r.chars[t]={id:u,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let t=0;t<o.length;t++){var d=parseInt(o[t].getAttribute("first"),10),c=parseInt(o[t].getAttribute("second"),10),p=parseInt(o[t].getAttribute("amount"),10);r.chars[h[c]].kerning[h[d]]=p}return r}},w={test(t){return!("string"!=typeof t||!t.includes("<font>"))&&_.test(i.e.get().parseXML(t))},parse(t){return _.parse(i.e.get().parseXML(t))}},L=[".xml",".fnt"];var s={extension:e.Ag.CacheParser,test:t=>t instanceof x,getCacheableAssets(t,e){const r={};return t.forEach(t=>{r[t]=e}),r[e.fontFamily+"-bitmap"]=e,r}},r={extension:{type:e.Ag.LoadParser,priority:r.T.Normal},test(t){return L.includes(h.A.extname(t).toLowerCase())},async testParse(t){return m.test(t)||w.test(t)},async parse(t,e,r){var t=(m.test(t)?m:w).parse(t),i=e["src"],s=t["pages"],a=[];for(let t=0;t<s.length;++t){var n=s[t].file,n=h.A.join(h.A.dirname(i),n),n=(0,O.Y)(n,i);a.push(n)}const o=await r.load(a);e=a.map(t=>o[t]);return new x({data:t,textures:e},i)},async load(t,e){return(await i.e.get().fetch(t)).text()},async unload(t,e,r){await Promise.all(t.pages.map(t=>r.unload(t.texture.source._sourceOrigin))),t.destroy()}},T=t(8218),M=t(7778),P=t(4835);class C extends M.mc{constructor(t){const{context:e,roundPixels:r,...i}=(t=t instanceof P.T?{context:t}:t)||{};super({label:"Graphics",...i}),this.canBundle=!0,this.renderPipeId="graphics",this._roundPixels=0,this._context=e||(this._ownedContext=new P.T),this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}onViewUpdate(){this._didChangeId+=4096,this._didGraphicsUpdate=!0,this.didViewUpdate||(this.didViewUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):!0!==t&&!0!==t?.context||this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new C(this._context.clone()):(this._ownedContext=null,new C(this._context))}lineStyle(t,e,r){(0,a.t)(a.l,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");var i={};return t&&(i.width=t),e&&(i.color=e),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(t,e){(0,a.t)(a.l,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");var r={};return t&&(r.color=t),e&&(r.alpha=e),this.context.fillStyle=r,this}endFill(){(0,a.t)(a.l,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();var t=this.context.strokeStyle;return t.width===P.T.defaultStrokeStyle.width&&t.color===P.T.defaultStrokeStyle.color&&t.alpha===P.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...t){return(0,a.t)(a.l,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return(0,a.t)(a.l,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return(0,a.t)(a.l,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return(0,a.t)(a.l,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return(0,a.t)(a.l,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return(0,a.t)(a.l,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}var H=t(9313),k=t(9104),A=t(5611);const V={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},N={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},B={};function $(t){return B[t]||(B[t]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;
    
                ${function(r){var i=[];if(1===r)i.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),i.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let t=0;t<r;t++)i.push(`@group(1) @binding(${e++}) var textureSource${t+1}: texture_2d<f32>;`),i.push(`@group(1) @binding(${e++}) var textureSampler${t+1}: sampler;`)}return i.join("\n")}(16)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);
    
                ${function(e){var r=[];if(1===e)r.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{r.push("switch vTextureId {");for(let t=0;t<e;t++)t===e-1?r.push("  default:{"):r.push(`  case ${t}:{`),r.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),r.push("      break;}");r.push("}")}return r.join("\n")}(16)}
            `}}),B[t]}const R={};function X(t){return R[t]||(R[t]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;
              
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;
    
                uniform sampler2D uTextures[${t}];
              
            `,main:`
    
                ${function(e){var r=[];for(let t=0;t<e;t++)0<t&&r.push("else"),t<e-1&&r.push(`if(vTextureId < ${t}.5)`),r.push("{"),r.push(`	outColor = texture(uTextures[${t}], vUV);`),r.push("}");return r.join("\n")}(16)}
            `}}),R[t]}var z=t(6665),F=t(7222),I=new Int32Array(k.k);for(let t=0;t<k.k;t++)I[t]=t;const j=new F.k({uTextures:{value:I,type:"i32",size:k.k}},{isStatic:!0});M=t(8475);const Y={name:"local-uniform-msdf-bit",vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:` 
            outColor = vColor * calculateMSDFAlpha(outColor, localUniforms.uDistance);
        `}},q={name:"local-uniform-msdf-bit",vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:` 
            outColor = vColor * calculateMSDFAlpha(outColor, uDistance);
        `}},K={name:"msdf-bit",fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, distance:f32) -> f32 {
                
                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));
            
                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                return alpha;
            }
        `}},Z={name:"msdf-bit",fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, float distance) {
                
                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));
               
                // SDF
                median = min(median, msdfColor.a);
            
                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
           
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                return alpha;
            }
        `}};class Q extends M.M{constructor(){var t=new F.k({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new H.u,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),e=(0,A.v)({name:"sdf-shader",bits:[V,$(k.k),Y,K,z.b]});super({glProgram:(0,A.I)({name:"sdf-shader",bits:[N,X(k.k),q,Z,z.m]}),gpuProgram:e,resources:{localUniforms:t,batchSamplers:j}})}}class U{constructor(t){this._gpuBitmapText={},this._renderer=t}validateRenderable(t){var e=this._getGpuBitmapText(t);return t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,e)),this._renderer.renderPipes.graphics.validateRenderable(e)}addRenderable(t,e){var r=this._getGpuBitmapText(t);J(t,r),t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,r)),this._renderer.renderPipes.graphics.addRenderable(r,e),r.context.customShader&&this._updateDistanceField(t)}destroyRenderable(t){this._destroyRenderableByUid(t.uid)}_destroyRenderableByUid(t){T.Z.return(this._gpuBitmapText[t]),this._gpuBitmapText[t]=null}updateRenderable(t){var e=this._getGpuBitmapText(t);J(t,e),this._renderer.renderPipes.graphics.updateRenderable(e),e.context.customShader&&this._updateDistanceField(t)}_updateContext(t,e){var r=e["context"],i=g.getFont(t.text,t._style),s=(r.clear(),"none"===i.distanceField.type||r.customShader||(this._sdfShader||(this._sdfShader=new Q),r.customShader=this._sdfShader),Array.from(t.text)),e=t._style;let a=(e._stroke?.width||0)/2;a+=i.baseLineOffset;var n=f(s,e,i);let o=0;var h=e.padding,l=n.scale,u=(r.translate(-t._anchor._x*n.width-h,-t._anchor._y*(n.height+n.offsetY)-h).scale(l,l),e._fill.color);for(let t=0;t<n.lines.length;t++){var d=n.lines[t];for(let t=0;t<d.charPositions.length;t++){var c=s[o++],c=i.chars[c];c?.texture&&r.texture(c.texture,u||"black",Math.round(d.charPositions[t]+c.xOffset),Math.round(a+c.yOffset))}a+=i.lineHeight}}_getGpuBitmapText(t){return this._gpuBitmapText[t.uid]||this.initGpuText(t)}initGpuText(t){var e=T.Z.get(C);return this._gpuBitmapText[t.uid]=e,this._updateContext(t,e),t.on("destroyed",()=>{this.destroyRenderable(t)}),this._gpuBitmapText[t.uid]}_updateDistanceField(t){var e=this._getGpuBitmapText(t).context,r=t._style.fontFamily,r=o.l.get(r+"-bitmap"),{a:i,b:s,c:a,d:n}=t.groupTransform,i=Math.sqrt(i*i+s*s),s=Math.sqrt(a*a+n*n),a=(Math.abs(i)+Math.abs(s))/2,n=r.baseRenderedFontSize/t._style.fontSize,i=t.resolution??this._renderer.resolution,s=a*r.distanceField.range*(1/n)*i;e.customShader.resources.localUniforms.uniforms.uDistance=s}destroy(){for(const t in this._gpuBitmapText)this._destroyRenderableByUid(t);this._gpuBitmapText=null,this._sdfShader?.destroy(!0),this._sdfShader=null,this._renderer=null}}function J(t,e){e.groupTransform=t.groupTransform,e.groupColorAlpha=t.groupColorAlpha,e.groupColor=t.groupColor,e.groupBlendMode=t.groupBlendMode,e.globalDisplayStatus=t.globalDisplayStatus,e.groupTransform=t.groupTransform,e.localDisplayStatus=t.localDisplayStatus,e.groupAlpha=t.groupAlpha,e._roundPixels=t._roundPixels}U.extension={type:[e.Ag.WebGLPipes,e.Ag.WebGPUPipes,e.Ag.CanvasPipes],name:"bitmapText"},e.XO.add(U,r,s)},7559:(t,e,r)=>{"use strict";var i=r(8507),s=r(7174),a=r(2048),g=r(8218),n=r(8422);class o{constructor(t){this._gpuText=Object.create(null),this._renderer=t}validateRenderable(t){var e=this._getGpuText(t),t=t._getKey();return e.textureNeedsUploading?!(e.textureNeedsUploading=!1):e.currentKey!==t}addRenderable(t){var e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),this._renderer.renderPipes.batch.addToBatch(e)}updateRenderable(t){var e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),e.batcher.updateElement(e)}destroyRenderable(t){this._destroyRenderableById(t.uid)}_destroyRenderableById(t){var e=this._gpuText[t];this._renderer.htmlText.decreaseReferenceCount(e.currentKey),g.Z.return(e.batchableSprite),this._gpuText[t]=null}_updateText(t){var e=t._getKey(),r=this._getGpuText(t),i=r.batchableSprite,r=(r.currentKey!==e&&this._updateGpuText(t).catch(t=>{console.error(t)}),t._didTextUpdate=!1,t._style.padding);(0,a.y)(i.bounds,t._anchor,i.texture,r)}async _updateGpuText(t){t._didTextUpdate=!1;var e,r,i=this._getGpuText(t);i.generatingTexture||(r=t._getKey(),this._renderer.htmlText.decreaseReferenceCount(i.currentKey),i.generatingTexture=!0,i.currentKey=r,r=t.resolution??this._renderer.resolution,r=await this._renderer.htmlText.getManagedTexture(t.text,r,t._style,t._getKey()),(e=i.batchableSprite).texture=i.texture=r,i.generatingTexture=!1,i.textureNeedsUploading=!0,t.onViewUpdate(),r=t._style.padding,(0,a.y)(e.bounds,t._anchor,e.texture,r))}_getGpuText(t){return this._gpuText[t.uid]||this.initGpuText(t)}initGpuText(t){var e={texture:s.g.EMPTY,currentKey:"--",batchableSprite:g.Z.get(n.K),textureNeedsUploading:!1,generatingTexture:!1},r=e.batchableSprite;return r.renderable=t,r.texture=s.g.EMPTY,r.bounds={minX:0,maxX:1,minY:0,maxY:0},r.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuText[t.uid]=e,t.on("destroyed",()=>{this.destroyRenderable(t)}),e}destroy(){for(const t in this._gpuText)this._destroyRenderableById(t);this._gpuText=null,this._renderer=null}}o.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"htmlText"};var h=r(2437),l=r(5099),x=r(1761);var u=r(268),m=r(2558);const d="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xhtml";class _{constructor(){this.svgRoot=document.createElementNS(d,"svg"),this.foreignObject=document.createElementNS(d,"foreignObject"),this.domElement=document.createElementNS(c,"div"),this.styleElement=document.createElementNS(c,"style"),this.image=new Image;var{foreignObject:t,svgRoot:e,styleElement:r,domElement:i}=this;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",e.appendChild(t),t.appendChild(r),t.appendChild(i)}}var p=r(8291),f=r(8011),v=r(2577);function y(t){var e=t._stroke,r=t._fill,r=[`div { ${["color: "+v.Q.shared.setValue(r.color).toHex(),`font-size: ${t.fontSize}px`,"font-family: "+t.fontFamily,"font-weight: "+t.fontWeight,"font-style: "+t.fontStyle,"font-variant: "+t.fontVariant,`letter-spacing: ${t.letterSpacing}px`,"text-align: "+t.align,`padding: ${t.padding}px`,"white-space: "+("pre"===t.whiteSpace&&t.wordWrap?"pre-wrap":t.whiteSpace),...t.lineHeight?[`line-height: ${t.lineHeight}px`]:[],...t.wordWrap?["word-wrap: "+(t.breakWords?"break-all":"break-word"),`max-width: ${t.wordWrapWidth}px`]:[],...e?[S(e)]:[],...t.dropShadow?[b(t.dropShadow)]:[],...t.cssOverrides].join(";")} }`],i=t.tagStyles,s=r;for(const o in i){var a=i[o],n=[];for(const h in a)T[h]?n.push(T[h](a[h])):w[h]&&n.push(w[h].replace("{{VALUE}}",a[h]));s.push(`${o} { ${n.join(";")} }`)}return r.join(" ")}function b(t){var e=v.Q.shared.setValue(t.color).setAlpha(t.alpha).toHexa(),r=Math.round(Math.cos(t.angle)*t.distance)+`px ${Math.round(Math.sin(t.angle)*t.distance)}px`;return 0<t.blur?`text-shadow: ${r} ${t.blur}px `+e:`text-shadow: ${r} `+e}function S(t){return[`-webkit-text-stroke-width: ${t.width}px`,"-webkit-text-stroke-color: "+v.Q.shared.setValue(t.color).toHex(),`text-stroke-width: ${t.width}px`,"text-stroke-color: "+v.Q.shared.setValue(t.color).toHex(),"paint-order: stroke"].join(";")}const w={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},T={fill:t=>"color: "+v.Q.shared.setValue(t).toHex(),breakWords:t=>"word-wrap: "+(t?"break-all":"break-word"),stroke:S,dropShadow:b};class M extends p.x{constructor(t={}){super(t),this._cssOverrides=[],this.cssOverrides??(this.cssOverrides=t.cssOverrides),this.tagStyles=t.tagStyles??{}}set cssOverrides(t){this._cssOverrides=t instanceof Array?t:[t],this.update()}get cssOverrides(){return this._cssOverrides}_generateKey(){return this._styleKey=(0,f.V)(this)+this._cssOverrides.join("-"),this._styleKey}update(){this._cssStyle=null,super.update()}clone(){return new M({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}get cssStyle(){return this._cssStyle||(this._cssStyle=y(this)),this._cssStyle}addOverride(...t){t=t.filter(t=>!this.cssOverrides.includes(t));0<t.length&&(this.cssOverrides.push(...t),this.update())}removeOverride(...t){const e=t.filter(t=>this.cssOverrides.includes(t));0<e.length&&(this.cssOverrides=this.cssOverrides.filter(t=>!e.includes(t)),this.update())}set fill(t){"string"!=typeof t&&"number"!=typeof t&&(0,u.R)("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=t}set stroke(t){t&&"string"!=typeof t&&"number"!=typeof t&&(0,u.R)("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=t}}var P=r(1979);async function C(t,e){e=await async function(t){const r=await(await x.e.get().fetch(t)).blob(),i=new FileReader;return await new Promise((t,e)=>{i.onloadend=()=>t(i.result),i.onerror=e,i.readAsDataURL(r)})}(e);return`@font-face {
        font-family: "${t.fontFamily}";
        src: url('${e}');
        font-weight: ${t.fontWeight};
        font-style: ${t.fontStyle};
    }`}const k=new Map;var A=r(7608);var B=r(4016);let R;class z{constructor(t){this._activeTextures={},this._renderer=t,this._createCanvas=t.type===l.W.WEBGPU}getTexture(t){return this._buildTexturePromise(t.text,t.resolution,t.style)}getManagedTexture(t,e,r,i){return this._activeTextures[i]?(this._increaseReferenceCount(i),this._activeTextures[i].promise):(t=this._buildTexturePromise(t,e,r).then(t=>this._activeTextures[i].texture=t),this._activeTextures[i]={texture:null,promise:t,usageCount:1},t)}async _buildTexturePromise(t,e,r){var i,s,a,n,o,h=g.Z.get(_),l=function(t,e){var r=e.fontFamily;const i=[],s={};function a(t){s[t]||(i.push(t),s[t]=!0)}if(t=t.match(/font-family:([^;"\s]+)/g),Array.isArray(r))for(let t=0;t<r.length;t++)a(r[t]);else a(r);t&&t.forEach(t=>{a(t.split(":")[1].trim())});for(const n in e.tagStyles)a(e.tagStyles[n].fontFamily);return i}(t,r),u=(u=l,i=r,s=M.defaultTextStyle,u=u.filter(t=>P.l.has(t+"-and-url")).map((t,e)=>{var r;return k.has(t)||(r=P.l.get(t+"-and-url")["url"],0===e?k.set(t,C(i,r)):k.set(t,C({fontWeight:s.fontWeight,fontStyle:s.fontStyle,fontFamily:t},r))),k.get(t)}),await(await Promise.all(u)).join("\n")),d=function(t,e,r,i){var{domElement:i,styleElement:s,svgRoot:a}=i=i||(R=R||new _),t=(i.innerHTML=`<style>${e.cssStyle}</style><div>${t}</div>`,i.setAttribute("style","transform-origin: top left; display: inline-block"),r&&(s.textContent=r),document.body.appendChild(a),i.getBoundingClientRect()),s=(a.remove(),B.P.measureFont(e.fontStyle).descent);return{width:t.width,height:t.height+s}}(t,r,u,h),c=Math.ceil(Math.ceil(Math.max(1,d.width)+2*r.padding)*e),d=Math.ceil(Math.ceil(Math.max(1,d.height)+2*r.padding)*e),p=h.image,c=(p.width=0|c,p.height=0|d,function(t,e,r,i,s){var{domElement:a,styleElement:n,svgRoot:o}=s,{width:e,height:t}=(a.innerHTML=`<style>${e.cssStyle}</style><div>${t}</div>`,a.setAttribute("style",`transform: scale(${r});transform-origin: top left; display: inline-block`),n.textContent=i,s.image);return o.setAttribute("width",e.toString()),o.setAttribute("height",t.toString()),(new XMLSerializer).serializeToString(o)}(t,r,e,u,h));a=p,n=c,d=x.e.get().getNavigator().userAgent,o=/^((?!chrome|android).)*safari/i.test(d)&&0<l.length,await new Promise(async t=>{o&&await new Promise(t=>setTimeout(t,100)),a.onload=()=>{t()},a.src="data:image/svg+xml;charset=utf8,"+encodeURIComponent(n),a.crossOrigin="anonymous"});let f=p;this._createCanvas&&(f=(t=p,r=e,(u=(r=A.N.getOptimalCanvasAndContext(t.width,t.height,r)).context).clearRect(0,0,t.width,t.height),u.drawImage(t,0,0),A.N.returnCanvasAndContext(r),r.canvas));c=(0,m.M)(f,p.width,p.height,e);return this._createCanvas&&this._renderer.texture.initSource(c.source),g.Z.return(h),c}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){const e=this._activeTextures[t];e&&(e.usageCount--,0===e.usageCount)&&(e.texture?this._cleanUp(e):e.promise.then(t=>{e.texture=t,this._cleanUp(e)}).catch(()=>{(0,u.R)("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[t]=null)}_cleanUp(t){h.W.returnTexture(t.texture),t.texture.source.resource=null,t.texture.source.uploadMethodId="unknown"}getReferenceCount(t){return this._activeTextures[t].usageCount}destroy(){this._activeTextures=null}}z.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem,i.Ag.CanvasSystem],name:"htmlText"},z.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"},i.XO.add(z),i.XO.add(o)},8291:(t,e,r)=>{"use strict";r.d(e,{x:()=>c});var e=r(4486),h=r(2577),l=r(4670),u=r(7276),i=r(4835),s=r(990),a=r(8011);const d=class d extends e.A{constructor(t={}){super();{var e=t,r;const s=e;if("boolean"==typeof s.dropShadow&&s.dropShadow&&(r=c.defaultDropShadow,e.dropShadow={alpha:s.dropShadowAlpha??r.alpha,angle:s.dropShadowAngle??r.angle,blur:s.dropShadowBlur??r.blur,color:s.dropShadowColor??r.color,distance:s.dropShadowDistance??r.distance}),void 0!==s.strokeThickness&&((0,l.t)(l.l,"strokeThickness is now a part of stroke"),r=s.stroke,e.stroke={color:r,width:s.strokeThickness}),Array.isArray(s.fill)){(0,l.t)(l.l,"gradient fill is now a fill pattern: `new FillGradient(...)`");const a=new u._(0,0,0,1.7*e.fontSize),n=s.fill.map(t=>h.Q.shared.setValue(t).toNumber());n.forEach((t,e)=>{e=s.fillGradientStops[e]??e/n.length;a.addColorStop(e,t)}),e.fill={fill:a}}}var i={...d.defaultTextStyle,...t};for(const o in i)this[o]=i[o];this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow=null!==t&&"object"==typeof t?{...d.defaultDropShadow,...t}:t?{...d.defaultDropShadow}:null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize="string"==typeof t?parseInt(t,10):t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._fill=(0,s.M)(0===t?"black":t,i.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._stroke=(0,s.M)(t,i.T.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=(0,a.V)(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){var t=d.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new d({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){this.removeAllListeners(),("boolean"==typeof t?t:t?.texture)&&(t="boolean"==typeof t?t:t?.textureSource,this._fill?.texture&&this._fill.texture.destroy(t),this._originalFill?.texture&&this._originalFill.texture.destroy(t),this._stroke?.texture&&this._stroke.texture.destroy(t),this._originalStroke?.texture)&&this._originalStroke.texture.destroy(t),this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}};d.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},d.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let c=d},4016:(t,e,r)=>{"use strict";r.d(e,{P:()=>a});var i=r(1761),p=r(1242);const s={willReadFrequently:!0},y=class y{static get experimentalLetterSpacingSupported(){let t=y._experimentalLetterSpacingSupported;var e;return void 0!==t&&(e=i.e.get().getCanvasRenderingContext2D().prototype,t=y._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e),t}constructor(t,e,r,i,s,a,n,o,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=s,this.lineWidths=a,this.lineHeight=n,this.maxLineWidth=o,this.fontProperties=h}static measureText(t=" ",e,r=y._canvas,i=e.wordWrap){var s=t+":"+e.styleKey;if(y._measurementCache[s])return y._measurementCache[s];var s=(0,p.Z)(e),a=y.measureFont(s),n=(0===a.fontSize&&(a.fontSize=e.fontSize,a.ascent=e.fontSize),y.__context);n.font=s;var o=(i?y._wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(o.length);let l=0;for(let t=0;t<o.length;t++){var u=y._measureText(o[t],e.letterSpacing,n);h[t]=u,l=Math.max(l,u)}s=e._stroke?.width||0;let d=l+s;e.dropShadow&&(d+=e.dropShadow.distance);i=e.lineHeight||a.fontSize+s;let c=Math.max(i,a.fontSize+2*s)+(o.length-1)*(i+e.leading);return e.dropShadow&&(c+=e.dropShadow.distance),new y(t,e,d,c,o,h,i+e.leading,l,a)}static _measureText(t,e,r){let i=!1,s=(y.experimentalLetterSpacingSupported&&(y.experimentalLetterSpacing?(r.letterSpacing=e+"px",r.textLetterSpacing=e+"px",i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px")),r.measureText(t).width);return 0<s&&(i?s-=e:s+=(y.graphemeSegmenter(t).length-1)*e),s}static _wordWrap(t,a,e=y._canvas){var n=e.getContext("2d",s);let o=0,h="",l="";var u=Object.create(null),{letterSpacing:d,whiteSpace:e}=a,r=y._collapseSpaces(e),i=y._collapseNewlines(e);let c=!r;var p=a.wordWrapWidth+d,f=y._tokenize(t);for(let t=0;t<f.length;t++){let s=f[t];if(y._isNewline(s)){if(!i){l+=y._addLine(h),c=!r,h="",o=0;continue}s=" "}if(r){var g=y.isBreakingSpace(s),x=y.isBreakingSpace(h[h.length-1]);if(g&&x)continue}g=y._getFromCache(s,d,u,n);if(p<g)if(""!==h&&(l+=y._addLine(h),h="",o=0),y.canBreakWords(s,a.breakWords)){var m=y.wordWrapSplit(s);for(let i=0;i<m.length;i++){let t=m[i],e=t,r=1;for(;m[i+r];){var _=m[i+r];if(y.canBreakChars(e,_,s,i,a.breakWords))break;t+=_,e=_,r++}i+=r-1;var v=y._getFromCache(t,d,u,n);v+o>p&&(l+=y._addLine(h),c=!1,h="",o=0),h+=t,o+=v}}else{0<h.length&&(l+=y._addLine(h),h="",o=0);x=t===f.length-1;l+=y._addLine(s,!x),c=!1,h="",o=0}else g+o>p&&(c=!1,l+=y._addLine(h),h="",o=0),(0<h.length||!y.isBreakingSpace(s)||c)&&(h+=s,o+=g)}return l+=y._addLine(h,!1)}static _addLine(t,e=!0){return t=y._trimRight(t),t=e?t+`
`:t}static _getFromCache(t,e,r,i){let s=r[t];return"number"!=typeof s&&(s=y._measureText(t,e,i)+e,r[t]=s),s}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(e){if("string"!=typeof e)return"";for(let t=e.length-1;0<=t;t--){var r=e[t];if(!y.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(t){return"string"==typeof t&&y._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return"string"==typeof t&&y._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(e){var r=[];let i="";if("string"==typeof e){for(let t=0;t<e.length;t++){var s=e[t],a=e[t+1];y.isBreakingSpace(s,a)||y._isNewline(s)?(""!==i&&(r.push(i),i=""),r.push(s)):i+=s}""!==i&&r.push(i)}return r}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,i,s){return!0}static wordWrapSplit(t){return y.graphemeSegmenter(t)}static measureFont(t){var e;return y._fonts[t]||((e=y._context).font=t,e={ascent:(e=e.measureText(y.METRICS_STRING+y.BASELINE_SYMBOL)).actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent,fontSize:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent},y._fonts[t]=e)}static clearMetrics(t=""){t?delete y._fonts[t]:y._fonts={}}static get _canvas(){if(!y.__canvas){let e;try{var t=new OffscreenCanvas(0,0);if(t.getContext("2d",s)?.measureText)return y.__canvas=t;e=i.e.get().createCanvas()}catch(t){e=i.e.get().createCanvas()}e.width=e.height=10,y.__canvas=e}return y.__canvas}static get _context(){return y.__context||(y.__context=y._canvas.getContext("2d",s)),y.__context}};y.METRICS_STRING="|ÉqÅ",y.BASELINE_SYMBOL="M",y.BASELINE_MULTIPLIER=1.4,y.HEIGHT_MULTIPLIER=2,y.graphemeSegmenter=(()=>{if("function"!=typeof Intl?.Segmenter)return t=>[...t];{const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(t=>t.segment)}})(),y.experimentalLetterSpacing=!1,y._fonts={},y._newlines=[10,13],y._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],y._measurementCache={};let a=y},1242:(t,e,r)=>{"use strict";r.d(e,{Z:()=>function(t){var e="number"==typeof t.fontSize?t.fontSize+"px":t.fontSize;let r=t.fontFamily;Array.isArray(t.fontFamily)||(r=t.fontFamily.split(","));for(let e=r.length-1;0<=e;e--){let t=r[e].trim();/([\"\'])[^\'\"]+\1/.test(t)||i.includes(t)||(t=`"${t}"`),r[e]=t}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} `+r.join(",")}});const i=["serif","sans-serif","monospace","cursive","fantasy","system-ui"]},3548:(t,e,r)=>{"use strict";r.d(e,{r:()=>function(t,e){{if(t.texture===h.g.WHITE&&!t.fill)return n.Q.shared.setValue(t.color).toHex();var r,i;if(!t.fill)return i=e.createPattern(t.texture.source.resource,"repeat"),(r=t.matrix.copyTo(o.u.shared)).scale(t.texture.frame.width,t.texture.frame.height),i.setTransform(r),i;if(t.fill instanceof d.m)return r=t.fill,i=e.createPattern(r.texture.source.resource,"repeat"),(s=r.transform.copyTo(o.u.shared)).scale(r.texture.frame.width,r.texture.frame.height),i.setTransform(s),i;if(t.fill instanceof u._){var s=t.fill;if("linear"===s.type){const a=e.createLinearGradient(s.x0,s.y0,s.x1,s.y1);return s.gradientStops.forEach(t=>{a.addColorStop(t.offset,n.Q.shared.setValue(t.color).toHex())}),a}}}return(0,l.R)("FillStyle not recognised",t),"red"}});var n=r(2577),o=r(9313),h=r(7174),l=r(268),u=r(7276),d=r(2806)},4577:(t,e,r)=>{"use strict";var i=r(8507),s=r(2048),a=r(8218),n=r(8422);class o{constructor(t){this._gpuText=Object.create(null),this._renderer=t}validateRenderable(t){var e=this._getGpuText(t),r=t._getKey();return e.currentKey!==r&&(r=t.resolution??this._renderer.resolution,{width:r,height:t}=this._renderer.canvasText.getTextureSize(t.text,r,t._style),1!==this._renderer.canvasText.getReferenceCount(e.currentKey)||r!==e.texture._source.width||t!==e.texture._source.height)}addRenderable(t,e){var r=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),this._renderer.renderPipes.batch.addToBatch(r)}updateRenderable(t){var e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),e.batcher.updateElement(e)}destroyRenderable(t){this._destroyRenderableById(t.uid)}_destroyRenderableById(t){var e=this._gpuText[t];this._renderer.canvasText.decreaseReferenceCount(e.currentKey),a.Z.return(e.batchableSprite),this._gpuText[t]=null}_updateText(t){var e=t._getKey(),r=this._getGpuText(t),i=r.batchableSprite,r=(r.currentKey!==e&&this._updateGpuText(t),t._didTextUpdate=!1,t._style.padding);(0,s.y)(i.bounds,t._anchor,i.texture,r)}_updateGpuText(t){var e=this._getGpuText(t),r=e.batchableSprite;e.texture&&this._renderer.canvasText.decreaseReferenceCount(e.currentKey),e.texture=r.texture=this._renderer.canvasText.getManagedTexture(t),e.currentKey=t._getKey(),r.texture=e.texture}_getGpuText(t){return this._gpuText[t.uid]||this.initGpuText(t)}initGpuText(t){var e={texture:null,currentKey:"--",batchableSprite:a.Z.get(n.K)};return e.batchableSprite.renderable=t,e.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},e.batchableSprite.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuText[t.uid]=e,this._updateText(t),t.on("destroyed",()=>{this.destroyRenderable(t)}),e}destroy(){for(const t in this._gpuText)this._destroyRenderableById(t);this._gpuText=null,this._renderer=null}}o.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"text"};var S=r(2577),h=r(9939),l=r(7608),u=r(2437),d=r(9252);function c(r,i,s){for(let t=0,e=4*s*i;t<i;++t,e+=4)if(0!==r[e+3])return;return 1}function p(r,t,i,s,a){var n=4*t;for(let t=s,e=s*n+4*i;t<=a;++t,e+=n)if(0!==r[e+3])return;return 1}var f=r(4670),g=r(8291),x=r(2558),w=r(4016),T=r(1242),M=r(3548);class m{constructor(t){this._activeTextures={},this._renderer=t}getTextureSize(t,e,r){var t=w.P.measureText(t||" ",r),i=Math.ceil(Math.ceil(Math.max(1,t.width)+2*r.padding)*e),t=Math.ceil(Math.ceil(Math.max(1,t.height)+2*r.padding)*e),i=Math.ceil(i-1e-6),t=Math.ceil(t-1e-6);return{width:(0,h.U5)(i),height:(0,h.U5)(t)}}getTexture(t,e,r,i){"string"==typeof t&&((0,f.t)("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),t={text:t,style:r,resolution:e}),t.style instanceof g.x||(t.style=new g.x(t.style));var{texture:r,canvasAndContext:e}=this.createTextureAndCanvas(t);return this._renderer.texture.initSource(r._source),l.N.returnCanvasAndContext(e),r}createTextureAndCanvas(t){var{text:e,style:r}=t,t=t.resolution??this._renderer.resolution,i=w.P.measureText(e||" ",r),s=Math.ceil(Math.ceil(Math.max(1,i.width)+2*r.padding)*t),i=Math.ceil(Math.ceil(Math.max(1,i.height)+2*r.padding)*t),a=l.N.getOptimalCanvasAndContext(s,i),n=a["canvas"],e=(this.renderTextToCanvas(e,r,t,a),(0,x.M)(n,s,i,t));return r.trim&&(s=function(t,e=1){var{width:r,height:i}=t;if(null===(t=t.getContext("2d",{willReadFrequently:!0})))throw new TypeError("Failed to get canvas 2D context");var s=t.getImageData(0,0,r,i).data;let a=0,n=0,o=r-1,h=i-1;for(;n<i&&c(s,r,n);)++n;if(n===i)return d.M.EMPTY;for(;c(s,r,h);)--h;for(;p(s,r,a,n,h);)++a;for(;p(s,r,o,n,h);)--o;return++o,++h,new d.M(a/e,n/e,(o-a)/e,(h-n)/e)}(n,t),e.frame.copyFrom(s),e.updateUvs()),{texture:e,canvasAndContext:a}}getManagedTexture(t){var e,r=t._getKey();return this._activeTextures[r]?(this._increaseReferenceCount(r),this._activeTextures[r].texture):({texture:t,canvasAndContext:e}=this.createTextureAndCanvas(t),this._activeTextures[r]={canvasAndContext:e,texture:t,usageCount:1},t)}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){var e=this._activeTextures[t];e.usageCount--,0===e.usageCount&&(l.N.returnCanvasAndContext(e.canvasAndContext),u.W.returnTexture(e.texture),(e=e.texture.source).resource=null,e.uploadMethodId="unknown",e.alphaMode="no-premultiply-alpha",this._activeTextures[t]=null)}getReferenceCount(t){return this._activeTextures[t].usageCount}renderTextToCanvas(t,r,i,s){var a,{canvas:e,context:n}=s,o=(0,T.Z)(r),t=w.P.measureText(t||" ",r),h=t.lines,l=t.lineHeight,u=t.lineWidths,d=t.maxLineWidth,c=t.fontProperties,p=e.height,e=(n.resetTransform(),n.scale(i,i),2*r.padding);n.clearRect(0,0,t.width+4+e,t.height+4+e),r._stroke?.width&&(t=r._stroke,n.lineWidth=t.width,n.miterLimit=t.miterLimit,n.lineJoin=t.join,n.lineCap=t.cap),n.font=o;let f;var g=r.dropShadow?2:1;for(let t=0;t<g;++t){var x,m,_=r.dropShadow&&0===t,v=_?Math.ceil(Math.max(1,p)+2*r.padding):0,y=v*i;_?(n.fillStyle="black",n.strokeStyle="black",x=(_=r.dropShadow).color,m=_.alpha,n.shadowColor=S.Q.shared.setValue(x).setAlpha(m).toRgbaString(),x=_.blur*i,m=_.distance*i,n.shadowBlur=x,n.shadowOffsetX=Math.cos(_.angle)*m,n.shadowOffsetY=Math.sin(_.angle)*m+y):(n.globalAlpha=r._fill?.alpha??1,n.fillStyle=r._fill?(0,M.r)(r._fill,n):null,r._stroke?.width&&(n.strokeStyle=(0,M.r)(r._stroke,n)),n.shadowColor="black");let e=(l-c.fontSize)/2;l-c.fontSize<0&&(e=0);var b=r._stroke?.width??0;for(let t=0;t<h.length;t++)a=(f=b/2)+t*l+c.ascent+e,"right"===r.align?f+=d-u[t]:"center"===r.align&&(f+=(d-u[t])/2),r._stroke?.width&&this._drawLetterSpacing(h[t],r,s,f+r.padding,a+r.padding-v,!0),void 0!==r._fill&&this._drawLetterSpacing(h[t],r,s,f+r.padding,a+r.padding-v)}}_drawLetterSpacing(e,t,r,s,a,n=!1){var o=r["context"],h=t.letterSpacing;let i=!1;if(w.P.experimentalLetterSpacingSupported&&(w.P.experimentalLetterSpacing?(o.letterSpacing=h+"px",o.textLetterSpacing=h+"px",i=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),0===h||i)n?o.strokeText(e,s,a):o.fillText(e,s,a);else{let t=s;var l=w.P.graphemeSegmenter(e);let i=o.measureText(e).width;for(let r=0;r<l.length;++r){var u=l[r];n?o.strokeText(u,t,a):o.fillText(u,t,a);let e="";for(let t=r+1;t<l.length;++t)e+=l[t];u=o.measureText(e).width,t+=i-u+h,i=u}}}destroy(){this._activeTextures=null}}m.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem,i.Ag.CanvasSystem],name:"canvasText"},i.XO.add(m),i.XO.add(o)},8011:(t,e,r)=>{"use strict";r.d(e,{V:()=>function(e){var r=[];let i=0;for(let t=0;t<a.length;t++){var s=a[t];r[i++]=e[s]}return i=n(e._fill,r,i),i=function(t,e,r){return t&&(r=n(t,e,r),e[r++]=t.width,e[r++]=t.alignment,e[r++]=t.cap,e[r++]=t.join,e[r++]=t.miterLimit),r}(e._stroke,r,i),r.join("-")}});const a=["_fontFamily","_fontStyle","_fontSize","_fontVariant","_fontWeight","_breakWords","_align","_leading","_letterSpacing","_lineHeight","_textBaseline","_whiteSpace","_wordWrap","_wordWrapWidth","_padding","_cssOverrides","_trim"];function n(t,e,r){return t&&(e[r++]=t.color,e[r++]=t.alpha,e[r++]=t.fill?.uid),r}},2558:(t,e,r)=>{"use strict";r.d(e,{M:()=>function(t,e,r,i){var s=n,s=(s.minX=0,s.minY=0,s.maxX=t.width/i|0,s.maxY=t.height/i|0,a.W.getOptimalTexture(s.width,s.height,i,!1));return s.source.uploadMethodId="image",s.source.resource=t,s.source.alphaMode="premultiply-alpha-on-upload",s.frame.width=e/i,s.frame.height=r/i,s.source.emit("update",s.source),s.updateUvs(),s}});var a=r(2437);const n=new(r(9636).c)}}]);